

============================== 2025-01-01 13:56:33.253905 | 2fdc7ed6-7cae-4d38-9d81-686fcb42bac3 ==============================
[0m13:56:33.253905 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:56:33.257660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:56:33.260667 [debug] [MainThread]: Tracking: tracking
[0m13:56:33.274830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m13:56:33.284769 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:56:33.285598 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:56:33.285873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>]}
[0m13:56:33.709692 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m13:56:33.721846 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m13:56:33.723995 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m13:56:33.725926 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m13:56:33.807768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e2ee30>]}
[0m13:56:33.816105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb71ffd0>]}
[0m13:56:33.816474 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:56:33.816791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7204c0>]}
[0m13:56:33.818419 [info ] [MainThread]: 
[0m13:56:33.820119 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:33.821475 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:56:33.829235 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:56:33.829480 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:56:33.829729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:33.871782 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:56:33.873310 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:56:33.875929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:56:33.880085 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:56:33.880305 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:56:33.880495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:33.885421 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:56:33.885687 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:56:33.885902 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:56:33.887313 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:56:33.888366 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:56:33.889019 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:56:33.893473 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:33.893741 [debug] [MainThread]: On master: BEGIN
[0m13:56:33.893937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:33.898048 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:56:33.898232 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:33.898382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:33.901834 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:56:33.902640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e7b850>]}
[0m13:56:33.902995 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:33.903512 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:33.903771 [debug] [MainThread]: On master: BEGIN
[0m13:56:33.904778 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:56:33.905084 [debug] [MainThread]: On master: COMMIT
[0m13:56:33.905293 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:33.905474 [debug] [MainThread]: On master: COMMIT
[0m13:56:33.906067 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:56:33.906258 [debug] [MainThread]: On master: Close
[0m13:56:33.906760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:33.907191 [info ] [MainThread]: 
[0m13:56:33.919209 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m13:56:33.919619 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:56:33.920248 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m13:56:33.920482 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m13:56:33.922446 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m13:56:33.924027 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 13:56:33.920666 => 2025-01-01 13:56:33.923967
[0m13:56:33.924235 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m13:56:33.950992 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m13:56:33.952738 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:56:33.952952 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m13:56:33.953165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:33.957817 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:56:33.958119 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:56:33.958337 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:56:33.960332 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:56:33.965712 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:56:33.965993 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:56:33.966786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:56:33.968876 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:56:33.969054 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:56:33.969788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:56:33.987501 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:56:33.987885 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:56:33.988166 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:56:33.989674 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:56:33.993485 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:56:33.993765 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:56:33.995481 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:56:33.996677 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 13:56:33.924388 => 2025-01-01 13:56:33.996626
[0m13:56:33.996883 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m13:56:33.997575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ddb400>]}
[0m13:56:33.998468 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m13:56:34.000009 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m13:56:34.000409 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m13:56:34.000710 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:56:34.001200 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m13:56:34.001397 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m13:56:34.003674 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m13:56:34.004676 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 13:56:34.001530 => 2025-01-01 13:56:34.004596
[0m13:56:34.004941 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m13:56:34.008326 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m13:56:34.008994 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:56:34.009154 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m13:56:34.009288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:34.014310 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:56:34.014517 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:56:34.014718 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:56:34.016854 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:56:34.018864 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:56:34.019046 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:56:34.019661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:56:34.022060 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:56:34.022221 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:56:34.022830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:56:34.024195 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:56:34.024355 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:56:34.024482 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:56:34.025114 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:56:34.026508 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:56:34.026700 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:56:34.027750 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:56:34.028686 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 13:56:34.005117 => 2025-01-01 13:56:34.028639
[0m13:56:34.028901 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m13:56:34.029467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff838e290>]}
[0m13:56:34.029881 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m13:56:34.030306 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m13:56:34.030722 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m13:56:34.031035 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:56:34.031524 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m13:56:34.031740 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m13:56:34.033668 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m13:56:34.034266 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 13:56:34.031884 => 2025-01-01 13:56:34.034226
[0m13:56:34.034443 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m13:56:34.037231 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m13:56:34.037790 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:56:34.037946 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m13:56:34.038093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:34.042055 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:56:34.042249 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:56:34.042415 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:56:34.044032 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:56:34.045973 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:56:34.046168 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:56:34.046918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:56:34.048686 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:56:34.048847 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:56:34.049433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:56:34.050879 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:56:34.051039 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:56:34.051188 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:56:34.052148 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:56:34.053594 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:56:34.053760 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:56:34.055138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:56:34.055941 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 13:56:34.034561 => 2025-01-01 13:56:34.055899
[0m13:56:34.056094 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m13:56:34.056621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff838ec80>]}
[0m13:56:34.056990 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m13:56:34.057287 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m13:56:34.058769 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m13:56:34.058998 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:56:34.059451 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m13:56:34.059643 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m13:56:34.062147 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m13:56:34.062781 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 13:56:34.059762 => 2025-01-01 13:56:34.062738
[0m13:56:34.062957 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m13:56:34.065820 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m13:56:34.066436 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:56:34.066613 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m13:56:34.066796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:34.071379 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:56:34.071557 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:56:34.071752 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id, title,release_date, price, rating, user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_ratings AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_ratings fwa ON fwf.film_id = fwa.film_id
  );
  
[0m13:56:34.072768 [debug] [Thread-1 (]: Postgres adapter: Postgres error: WITH query name "films_with_ratings" specified more than once
LINE 20: films_with_ratings AS(
         ^

[0m13:56:34.073003 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m13:56:34.073784 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 13:56:34.063072 => 2025-01-01 13:56:34.073737
[0m13:56:34.074006 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m13:56:34.075933 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  WITH query name "films_with_ratings" specified more than once
  LINE 20: films_with_ratings AS(
           ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m13:56:34.076277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fdc7ed6-7cae-4d38-9d81-686fcb42bac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff838eb00>]}
[0m13:56:34.076614 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m13:56:34.077063 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m13:56:34.078413 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:34.078666 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:34.078829 [debug] [MainThread]: On master: BEGIN
[0m13:56:34.078979 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:34.083064 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:56:34.083283 [debug] [MainThread]: On master: COMMIT
[0m13:56:34.083473 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:34.083652 [debug] [MainThread]: On master: COMMIT
[0m13:56:34.084239 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:56:34.084429 [debug] [MainThread]: On master: Close
[0m13:56:34.084878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:34.085065 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m13:56:34.085470 [info ] [MainThread]: 
[0m13:56:34.085984 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:56:34.086440 [debug] [MainThread]: Command end result
[0m13:56:34.092488 [info ] [MainThread]: 
[0m13:56:34.092774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:56:34.093127 [info ] [MainThread]: 
[0m13:56:34.093386 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m13:56:34.093584 [error] [MainThread]:   WITH query name "films_with_ratings" specified more than once
[0m13:56:34.093874 [error] [MainThread]:   LINE 20: films_with_ratings AS(
[0m13:56:34.094039 [error] [MainThread]:            ^
[0m13:56:34.094285 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m13:56:34.094596 [info ] [MainThread]: 
[0m13:56:34.094923 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:56:34.095320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d98a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83da0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d8bb0>]}
[0m13:56:34.095598 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 13:59:04.335129 | f843656e-9490-49c8-8310-dc8b0e137c16 ==============================
[0m13:59:04.335129 [info ] [MainThread]: Running with dbt=1.4.7
[0m13:59:04.339288 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:59:04.339583 [debug] [MainThread]: Tracking: tracking
[0m13:59:04.352944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m13:59:04.363283 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m13:59:04.388570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:04.392040 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m13:59:04.456272 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m13:59:04.503845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f843656e-9490-49c8-8310-dc8b0e137c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e94d30>]}
[0m13:59:04.511924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f843656e-9490-49c8-8310-dc8b0e137c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7026b0>]}
[0m13:59:04.512297 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m13:59:04.512574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f843656e-9490-49c8-8310-dc8b0e137c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72c910>]}
[0m13:59:04.514154 [info ] [MainThread]: 
[0m13:59:04.515853 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:04.517222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m13:59:04.525284 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m13:59:04.525565 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m13:59:04.525768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:04.566830 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m13:59:04.568289 [debug] [ThreadPool]: On list_destination_db: Close
[0m13:59:04.570683 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m13:59:04.574699 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:59:04.574917 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m13:59:04.575125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:59:04.580024 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:59:04.580255 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m13:59:04.580455 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:59:04.581915 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m13:59:04.582986 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m13:59:04.583665 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m13:59:04.587896 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:04.588194 [debug] [MainThread]: On master: BEGIN
[0m13:59:04.588383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:04.593505 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:59:04.593731 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:04.593941 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:59:04.597242 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m13:59:04.598048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f843656e-9490-49c8-8310-dc8b0e137c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84ec700>]}
[0m13:59:04.598374 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:04.598985 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:04.599176 [debug] [MainThread]: On master: BEGIN
[0m13:59:04.600186 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:59:04.600494 [debug] [MainThread]: On master: COMMIT
[0m13:59:04.600704 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:04.600915 [debug] [MainThread]: On master: COMMIT
[0m13:59:04.601553 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:59:04.601803 [debug] [MainThread]: On master: Close
[0m13:59:04.602352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:04.602753 [info ] [MainThread]: 
[0m13:59:04.615552 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m13:59:04.616007 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m13:59:04.616613 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m13:59:04.617017 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m13:59:04.619263 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m13:59:04.620674 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 13:59:04.617316 => 2025-01-01 13:59:04.620622
[0m13:59:04.620953 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m13:59:04.648665 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m13:59:04.649632 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:59:04.649829 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m13:59:04.650013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:04.654500 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:59:04.654759 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:59:04.654984 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m13:59:04.656720 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:59:04.661126 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:59:04.661321 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m13:59:04.662035 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:59:04.663798 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:59:04.663962 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m13:59:04.664480 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:59:04.678984 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:59:04.679238 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:59:04.679414 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m13:59:04.680325 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:59:04.683599 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m13:59:04.683796 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m13:59:04.685040 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:59:04.685894 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 13:59:04.621095 => 2025-01-01 13:59:04.685848
[0m13:59:04.686083 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m13:59:04.686653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f843656e-9490-49c8-8310-dc8b0e137c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff85368c0>]}
[0m13:59:04.687473 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m13:59:04.688940 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m13:59:04.689209 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m13:59:04.689474 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m13:59:04.689985 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m13:59:04.690203 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m13:59:04.691914 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m13:59:04.692449 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 13:59:04.690339 => 2025-01-01 13:59:04.692416
[0m13:59:04.692611 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m13:59:04.695498 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m13:59:04.695960 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:59:04.696098 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m13:59:04.696233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:04.701101 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:59:04.701294 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:59:04.701431 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m13:59:04.703318 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:59:04.706052 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:59:04.706235 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m13:59:04.706773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:59:04.708489 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:59:04.708646 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m13:59:04.709198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:59:04.710554 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:59:04.710716 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:59:04.710854 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m13:59:04.711419 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:59:04.712722 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m13:59:04.712880 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m13:59:04.713770 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:59:04.714579 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 13:59:04.692722 => 2025-01-01 13:59:04.714542
[0m13:59:04.714758 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m13:59:04.715270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f843656e-9490-49c8-8310-dc8b0e137c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8536b30>]}
[0m13:59:04.715626 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m13:59:04.716048 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m13:59:04.716360 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m13:59:04.716645 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m13:59:04.717094 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m13:59:04.717275 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m13:59:04.719063 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m13:59:04.719584 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 13:59:04.717401 => 2025-01-01 13:59:04.719553
[0m13:59:04.719749 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m13:59:04.722493 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m13:59:04.722932 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:59:04.723063 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m13:59:04.723183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:04.726941 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:59:04.727129 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:59:04.727264 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m13:59:04.729069 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m13:59:04.730891 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:59:04.731091 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m13:59:04.731712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:59:04.733509 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:59:04.733685 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m13:59:04.734234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m13:59:04.735638 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:59:04.735798 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:59:04.735921 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m13:59:04.736534 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m13:59:04.737962 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m13:59:04.738118 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m13:59:04.739108 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m13:59:04.739912 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 13:59:04.719855 => 2025-01-01 13:59:04.739877
[0m13:59:04.740068 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m13:59:04.740569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f843656e-9490-49c8-8310-dc8b0e137c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83ad090>]}
[0m13:59:04.740977 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m13:59:04.741264 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m13:59:04.742714 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m13:59:04.742979 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m13:59:04.743426 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m13:59:04.743596 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m13:59:04.745967 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m13:59:04.746527 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 13:59:04.743704 => 2025-01-01 13:59:04.746494
[0m13:59:04.746685 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m13:59:04.750246 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m13:59:04.750768 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:59:04.750911 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m13:59:04.751054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:04.755585 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m13:59:04.755772 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m13:59:04.755945 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id, title,release_date, price, rating, user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
)

films_with_ratings AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_ratings fwa ON fwf.film_id = fwa.film_id
  );
  
[0m13:59:04.756910 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "films_with_ratings"
LINE 20: films_with_ratings AS(
         ^

[0m13:59:04.757076 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m13:59:04.757759 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 13:59:04.746809 => 2025-01-01 13:59:04.757708
[0m13:59:04.758034 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m13:59:04.759788 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "films_with_ratings"
  LINE 20: films_with_ratings AS(
           ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m13:59:04.760121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f843656e-9490-49c8-8310-dc8b0e137c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f40a0>]}
[0m13:59:04.760416 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m13:59:04.760827 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m13:59:04.761786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:04.762084 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:04.762245 [debug] [MainThread]: On master: BEGIN
[0m13:59:04.762381 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:04.766475 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:59:04.766679 [debug] [MainThread]: On master: COMMIT
[0m13:59:04.766886 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:04.767050 [debug] [MainThread]: On master: COMMIT
[0m13:59:04.767494 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:59:04.767684 [debug] [MainThread]: On master: Close
[0m13:59:04.768126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:04.768306 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m13:59:04.768693 [info ] [MainThread]: 
[0m13:59:04.769032 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m13:59:04.769389 [debug] [MainThread]: Command end result
[0m13:59:04.774191 [info ] [MainThread]: 
[0m13:59:04.774459 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:59:04.774676 [info ] [MainThread]: 
[0m13:59:04.774907 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m13:59:04.775148 [error] [MainThread]:   syntax error at or near "films_with_ratings"
[0m13:59:04.775435 [error] [MainThread]:   LINE 20: films_with_ratings AS(
[0m13:59:04.775654 [error] [MainThread]:            ^
[0m13:59:04.775926 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m13:59:04.776219 [info ] [MainThread]: 
[0m13:59:04.776445 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:59:04.776777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f4c40>]}
[0m13:59:04.777013 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:14:40.497562 | af1cb2e5-cfa0-4578-9252-78173f4bd1a9 ==============================
[0m14:14:40.497562 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:14:40.501959 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:14:40.502259 [debug] [MainThread]: Tracking: tracking
[0m14:14:40.516775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m14:14:40.529999 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:14:40.557782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:14:40.558503 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:14:40.618289 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m14:14:40.670724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af1cb2e5-cfa0-4578-9252-78173f4bd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e95120>]}
[0m14:14:40.680257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af1cb2e5-cfa0-4578-9252-78173f4bd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702680>]}
[0m14:14:40.680664 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:14:40.680987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af1cb2e5-cfa0-4578-9252-78173f4bd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72c940>]}
[0m14:14:40.682803 [info ] [MainThread]: 
[0m14:14:40.684695 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:40.686088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:14:40.695087 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:14:40.695417 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:14:40.695629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:40.738311 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:14:40.739990 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:14:40.742584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:14:40.747078 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:14:40.747313 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:14:40.747511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:40.752804 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:14:40.753047 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:14:40.753257 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:14:40.754782 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:14:40.755877 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:14:40.756543 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:14:40.761966 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:40.762247 [debug] [MainThread]: On master: BEGIN
[0m14:14:40.762468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:40.766831 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:14:40.767139 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:40.767334 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:40.770514 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:14:40.771351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af1cb2e5-cfa0-4578-9252-78173f4bd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e13580>]}
[0m14:14:40.771682 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:40.772313 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:40.772496 [debug] [MainThread]: On master: BEGIN
[0m14:14:40.773610 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:14:40.773906 [debug] [MainThread]: On master: COMMIT
[0m14:14:40.774198 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:40.774380 [debug] [MainThread]: On master: COMMIT
[0m14:14:40.774987 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:14:40.775245 [debug] [MainThread]: On master: Close
[0m14:14:40.775771 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:40.776025 [info ] [MainThread]: 
[0m14:14:40.788017 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:14:40.788417 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:14:40.789072 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:14:40.789361 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:14:40.791605 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:14:40.793852 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:14:40.789544 => 2025-01-01 14:14:40.793786
[0m14:14:40.794136 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:14:40.822987 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:14:40.824034 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:14:40.824228 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:14:40.824423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:40.829308 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:14:40.829497 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:14:40.829631 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:14:40.831299 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:14:40.835781 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:14:40.836043 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:14:40.836656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:14:40.838411 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:14:40.838579 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:14:40.839067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:14:40.853606 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:14:40.853822 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:14:40.854026 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:14:40.854988 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:14:40.858299 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:14:40.858469 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:14:40.859686 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:14:40.860550 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:14:40.794299 => 2025-01-01 14:14:40.860509
[0m14:14:40.860728 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:14:40.861346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1cb2e5-cfa0-4578-9252-78173f4bd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff853e860>]}
[0m14:14:40.862132 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:14:40.863605 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:14:40.863917 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:14:40.864218 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:14:40.864710 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:14:40.864939 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:14:40.866736 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:14:40.867355 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:14:40.865098 => 2025-01-01 14:14:40.867319
[0m14:14:40.867531 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:14:40.870509 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:14:40.870991 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:14:40.871135 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:14:40.871271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:40.876657 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:14:40.876834 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:14:40.877053 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:14:40.878924 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:14:40.881447 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:14:40.881624 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:14:40.882172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:14:40.883818 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:14:40.883979 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:14:40.884529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:14:40.885849 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:14:40.886019 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:14:40.886149 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:14:40.886739 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:14:40.888099 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:14:40.888243 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:14:40.889393 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:14:40.890135 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:14:40.867659 => 2025-01-01 14:14:40.890100
[0m14:14:40.890295 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:14:40.890797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1cb2e5-cfa0-4578-9252-78173f4bd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e634f0>]}
[0m14:14:40.891164 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m14:14:40.891562 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:14:40.891934 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:14:40.892209 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m14:14:40.892695 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:14:40.892909 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:14:40.894755 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:14:40.895317 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:14:40.893060 => 2025-01-01 14:14:40.895285
[0m14:14:40.895472 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:14:40.898227 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:14:40.898689 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:14:40.898819 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:14:40.898997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:40.903374 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:14:40.903584 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:14:40.903736 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:14:40.905432 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:14:40.907316 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:14:40.907484 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:14:40.908205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:14:40.909975 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:14:40.910171 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:14:40.910742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:14:40.912139 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:14:40.912290 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:14:40.912419 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:14:40.913013 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:14:40.914407 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:14:40.914573 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:14:40.915565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:14:40.916391 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:14:40.895578 => 2025-01-01 14:14:40.916350
[0m14:14:40.916555 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:14:40.917092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1cb2e5-cfa0-4578-9252-78173f4bd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff853ead0>]}
[0m14:14:40.917420 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m14:14:40.917741 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:14:40.919177 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:14:40.919397 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:14:40.919902 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:14:40.920109 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:14:40.922493 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:14:40.923150 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:14:40.920222 => 2025-01-01 14:14:40.923109
[0m14:14:40.923343 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:14:40.926849 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:14:40.927387 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:14:40.927526 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:14:40.927650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:40.932812 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:14:40.932994 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:14:40.933148 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_ratings fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:14:40.934579 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column fwa.actors does not exist
LINE 30: SELECT fwf.*, fwa.actors
                       ^

[0m14:14:40.934748 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m14:14:40.935453 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:14:40.923461 => 2025-01-01 14:14:40.935413
[0m14:14:40.935610 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:14:40.937172 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  column fwa.actors does not exist
  LINE 30: SELECT fwf.*, fwa.actors
                         ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m14:14:40.937496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1cb2e5-cfa0-4578-9252-78173f4bd1a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f5210>]}
[0m14:14:40.937823 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m14:14:40.938197 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:14:40.939132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:40.939382 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:40.939557 [debug] [MainThread]: On master: BEGIN
[0m14:14:40.939717 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:40.943539 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:14:40.943752 [debug] [MainThread]: On master: COMMIT
[0m14:14:40.943936 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:40.944175 [debug] [MainThread]: On master: COMMIT
[0m14:14:40.944745 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:14:40.944940 [debug] [MainThread]: On master: Close
[0m14:14:40.945399 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:40.945558 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m14:14:40.945979 [info ] [MainThread]: 
[0m14:14:40.946402 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:14:40.946850 [debug] [MainThread]: Command end result
[0m14:14:40.952305 [info ] [MainThread]: 
[0m14:14:40.952670 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:14:40.952889 [info ] [MainThread]: 
[0m14:14:40.953091 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:14:40.953323 [error] [MainThread]:   column fwa.actors does not exist
[0m14:14:40.953560 [error] [MainThread]:   LINE 30: SELECT fwf.*, fwa.actors
[0m14:14:40.953810 [error] [MainThread]:                          ^
[0m14:14:40.954069 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m14:14:40.954314 [info ] [MainThread]: 
[0m14:14:40.954583 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:14:40.954883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f51e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f4160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f41c0>]}
[0m14:14:40.955102 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:16:23.299696 | 2837f6cc-605b-46ea-b623-ab9561152fcc ==============================
[0m14:16:23.299696 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:16:23.302809 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:16:23.303044 [debug] [MainThread]: Tracking: tracking
[0m14:16:23.316855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m14:16:23.328105 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:16:23.353485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:16:23.354008 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:16:23.411990 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m14:16:23.460472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2837f6cc-605b-46ea-b623-ab9561152fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e940d0>]}
[0m14:16:23.468703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2837f6cc-605b-46ea-b623-ab9561152fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7026b0>]}
[0m14:16:23.469214 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:16:23.469632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2837f6cc-605b-46ea-b623-ab9561152fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72dde0>]}
[0m14:16:23.471118 [info ] [MainThread]: 
[0m14:16:23.472873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:23.474340 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:16:23.482162 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:16:23.482419 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:16:23.482621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:23.523829 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:16:23.525291 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:16:23.527592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:16:23.531683 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:16:23.531904 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:16:23.532111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:23.537336 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:16:23.537617 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:16:23.537832 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:16:23.539275 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:16:23.540423 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:16:23.541120 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:16:23.545404 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:23.545650 [debug] [MainThread]: On master: BEGIN
[0m14:16:23.545844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:23.551253 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:16:23.551522 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:23.551709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:23.554932 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:16:23.555715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2837f6cc-605b-46ea-b623-ab9561152fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e13610>]}
[0m14:16:23.556026 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:23.556617 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:23.556795 [debug] [MainThread]: On master: BEGIN
[0m14:16:23.557749 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:16:23.558003 [debug] [MainThread]: On master: COMMIT
[0m14:16:23.558218 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:23.558405 [debug] [MainThread]: On master: COMMIT
[0m14:16:23.558958 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:16:23.559142 [debug] [MainThread]: On master: Close
[0m14:16:23.559617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:23.559937 [info ] [MainThread]: 
[0m14:16:23.572204 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:16:23.572588 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:16:23.573171 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:16:23.573425 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:16:23.575444 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:16:23.577616 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:16:23.573616 => 2025-01-01 14:16:23.577562
[0m14:16:23.577823 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:16:23.604789 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:16:23.605934 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:16:23.606094 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:16:23.606251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:23.610688 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:16:23.610925 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:16:23.611097 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:16:23.613029 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:16:23.617246 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:16:23.617431 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:16:23.618797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:16:23.620603 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:16:23.620767 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:16:23.621277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:16:23.635536 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:16:23.635766 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:16:23.635939 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:16:23.636830 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:16:23.640204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:16:23.640380 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:16:23.641608 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:16:23.642443 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:16:23.577978 => 2025-01-01 14:16:23.642400
[0m14:16:23.642622 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:16:23.643169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2837f6cc-605b-46ea-b623-ab9561152fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff853a860>]}
[0m14:16:23.643932 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:16:23.645431 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:16:23.645710 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:16:23.645970 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:16:23.646450 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:16:23.646658 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:16:23.648348 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:16:23.648959 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:16:23.646799 => 2025-01-01 14:16:23.648927
[0m14:16:23.649131 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:16:23.651978 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:16:23.652482 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:16:23.652622 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:16:23.652749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:23.656729 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:16:23.656901 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:16:23.657035 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:16:23.658808 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:16:23.661268 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:16:23.661479 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:16:23.662128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:16:23.663816 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:16:23.664012 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:16:23.664552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:16:23.665924 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:16:23.666082 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:16:23.666204 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:16:23.666813 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:16:23.668154 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:16:23.668312 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:16:23.669209 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:16:23.670016 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:16:23.649251 => 2025-01-01 14:16:23.669987
[0m14:16:23.670181 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:16:23.670670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2837f6cc-605b-46ea-b623-ab9561152fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff853abf0>]}
[0m14:16:23.671020 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.02s]
[0m14:16:23.671327 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:16:23.671651 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:16:23.671928 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m14:16:23.672485 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:16:23.672735 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:16:23.674603 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:16:23.675280 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:16:23.672889 => 2025-01-01 14:16:23.675247
[0m14:16:23.675451 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:16:23.678241 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:16:23.678713 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:16:23.678850 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:16:23.678972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:23.682595 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:16:23.682766 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:16:23.682912 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:16:23.684423 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:16:23.686284 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:16:23.686477 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:16:23.687736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:16:23.689503 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:16:23.689656 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:16:23.690106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:16:23.691442 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:16:23.691601 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:16:23.691744 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:16:23.692352 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:16:23.693786 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:16:23.693942 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:16:23.694953 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:16:23.695793 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:16:23.675580 => 2025-01-01 14:16:23.695761
[0m14:16:23.695959 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:16:23.696502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2837f6cc-605b-46ea-b623-ab9561152fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83acca0>]}
[0m14:16:23.696857 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m14:16:23.697194 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:16:23.698793 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:16:23.699027 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:16:23.699485 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:16:23.699650 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:16:23.701990 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:16:23.702583 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:16:23.699769 => 2025-01-01 14:16:23.702543
[0m14:16:23.702752 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:16:23.706686 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:16:23.707363 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:16:23.707504 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:16:23.707627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:23.711921 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:16:23.712085 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:16:23.712230 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:16:23.715699 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:16:23.717526 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:16:23.717692 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m14:16:23.718208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:16:23.719432 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:16:23.719606 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:16:23.719741 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:16:23.720327 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:16:23.721688 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:16:23.721839 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m14:16:23.722323 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:16:23.723089 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:16:23.702880 => 2025-01-01 14:16:23.723050
[0m14:16:23.723248 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:16:23.723777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2837f6cc-605b-46ea-b623-ab9561152fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83c3cd0>]}
[0m14:16:23.724105 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.02s]
[0m14:16:23.724399 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:16:23.725469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:23.725708 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:23.725864 [debug] [MainThread]: On master: BEGIN
[0m14:16:23.726010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:23.729704 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:16:23.729885 [debug] [MainThread]: On master: COMMIT
[0m14:16:23.730028 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:23.730160 [debug] [MainThread]: On master: COMMIT
[0m14:16:23.730614 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:16:23.730789 [debug] [MainThread]: On master: Close
[0m14:16:23.731238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:23.731427 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m14:16:23.731822 [info ] [MainThread]: 
[0m14:16:23.732201 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:16:23.732632 [debug] [MainThread]: Command end result
[0m14:16:23.738510 [info ] [MainThread]: 
[0m14:16:23.738855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:16:23.739105 [info ] [MainThread]: 
[0m14:16:23.739422 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:16:23.739794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d5ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f59f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83c32b0>]}
[0m14:16:23.740019 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:20:19.038860 | 4542ef07-c8ca-4d3a-844b-4c7fb787ec5b ==============================
[0m14:20:19.038860 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:20:19.042769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:20:19.045672 [debug] [MainThread]: Tracking: tracking
[0m14:20:19.058988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79f010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb79ca60>]}
[0m14:20:19.068940 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:20:19.094106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:20:19.097646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:20:19.103237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4542ef07-c8ca-4d3a-844b-4c7fb787ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e57f40>]}
[0m14:20:19.119170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4542ef07-c8ca-4d3a-844b-4c7fb787ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e15f00>]}
[0m14:20:19.119472 [info ] [MainThread]: Found 4 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:20:19.119778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4542ef07-c8ca-4d3a-844b-4c7fb787ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd256620>]}
[0m14:20:19.121288 [info ] [MainThread]: 
[0m14:20:19.122953 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:19.124923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:20:19.134257 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:20:19.134555 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:20:19.134800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:19.175729 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:20:19.177247 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:20:19.179401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:20:19.183478 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:20:19.183713 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:20:19.183916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:19.188804 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:20:19.189067 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:20:19.189262 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:20:19.190766 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:20:19.191653 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:20:19.192309 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:20:19.196648 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:19.196905 [debug] [MainThread]: On master: BEGIN
[0m14:20:19.197115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:19.201417 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:20:19.201667 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:19.201872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:20:19.205168 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:20:19.205960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4542ef07-c8ca-4d3a-844b-4c7fb787ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e93880>]}
[0m14:20:19.206266 [debug] [MainThread]: On master: ROLLBACK
[0m14:20:19.206893 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:19.207123 [debug] [MainThread]: On master: BEGIN
[0m14:20:19.208089 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:20:19.208278 [debug] [MainThread]: On master: COMMIT
[0m14:20:19.208467 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:19.208646 [debug] [MainThread]: On master: COMMIT
[0m14:20:19.209199 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:20:19.209381 [debug] [MainThread]: On master: Close
[0m14:20:19.209851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:19.210209 [info ] [MainThread]: 
[0m14:20:19.213137 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:20:19.213517 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m14:20:19.214046 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:20:19.214382 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:20:19.216260 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:20:19.218268 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:20:19.214589 => 2025-01-01 14:20:19.218189
[0m14:20:19.218493 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:20:19.246597 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:20:19.247310 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:20:19.247467 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:20:19.247617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:19.251414 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:20:19.251600 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:20:19.251740 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:20:19.253607 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m14:20:19.257795 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:20:19.257977 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:20:19.258577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:20:19.260474 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:20:19.260654 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:20:19.261205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:20:19.275434 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:20:19.275650 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:20:19.275831 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:20:19.276717 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:20:19.279881 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:20:19.280056 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:20:19.281182 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:20:19.282081 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:20:19.218669 => 2025-01-01 14:20:19.282028
[0m14:20:19.282250 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:20:19.282911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4542ef07-c8ca-4d3a-844b-4c7fb787ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cb9bd0>]}
[0m14:20:19.283696 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 40[0m in 0.07s]
[0m14:20:19.285137 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:20:19.285431 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:20:19.285710 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m14:20:19.286121 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:20:19.286296 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:20:19.287986 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:20:19.288540 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:20:19.286414 => 2025-01-01 14:20:19.288501
[0m14:20:19.288698 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:20:19.291543 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:20:19.292044 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:20:19.292179 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:20:19.292303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:19.297082 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:20:19.297246 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:20:19.297368 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:20:19.298817 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m14:20:19.300628 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:20:19.300890 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:20:19.301933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:20:19.303673 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:20:19.303838 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:20:19.304331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:20:19.305714 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:20:19.305860 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:20:19.305981 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:20:19.306571 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:20:19.307902 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:20:19.308043 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:20:19.308823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:20:19.309688 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:20:19.288822 => 2025-01-01 14:20:19.309654
[0m14:20:19.309882 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:20:19.310433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4542ef07-c8ca-4d3a-844b-4c7fb787ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e91450>]}
[0m14:20:19.310781 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 40[0m in 0.02s]
[0m14:20:19.311037 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:20:19.311383 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:20:19.311669 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m14:20:19.312069 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:20:19.312250 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:20:19.314670 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:20:19.315194 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:20:19.312362 => 2025-01-01 14:20:19.315163
[0m14:20:19.315366 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:20:19.318060 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:20:19.318522 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:20:19.318667 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:20:19.318789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:19.322497 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:20:19.322682 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:20:19.322818 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:20:19.324246 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m14:20:19.325957 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:20:19.326148 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:20:19.326895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:20:19.328519 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:20:19.328691 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:20:19.329182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:20:19.330481 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:20:19.330637 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:20:19.330790 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:20:19.331579 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:20:19.332996 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:20:19.333155 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:20:19.333946 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:20:19.334839 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:20:19.315492 => 2025-01-01 14:20:19.334809
[0m14:20:19.334997 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:20:19.335490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4542ef07-c8ca-4d3a-844b-4c7fb787ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d01060>]}
[0m14:20:19.335798 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 40[0m in 0.02s]
[0m14:20:19.336063 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:20:19.337476 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:20:19.337697 [info ] [Thread-1 (]: 4 of 4 START sql table model public.film_ratings ............................... [RUN]
[0m14:20:19.338079 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:20:19.338240 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:20:19.340454 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:20:19.340948 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:20:19.338345 => 2025-01-01 14:20:19.340918
[0m14:20:19.341101 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:20:19.343823 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:20:19.344262 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:20:19.344394 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:20:19.344513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:19.349280 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:20:19.349470 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:20:19.349644 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:20:19.352930 [debug] [Thread-1 (]: SQL status: SELECT 40 in 0 seconds
[0m14:20:19.354758 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:20:19.354917 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings" rename to "film_ratings__dbt_backup"
[0m14:20:19.355458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:20:19.357058 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:20:19.357206 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m14:20:19.357701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:20:19.359049 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:20:19.359190 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:20:19.359308 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:20:19.359891 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:20:19.361834 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:20:19.361972 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m14:20:19.362768 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:20:19.363577 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:20:19.341210 => 2025-01-01 14:20:19.363543
[0m14:20:19.363738 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:20:19.364263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4542ef07-c8ca-4d3a-844b-4c7fb787ec5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d93dc0>]}
[0m14:20:19.364616 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.film_ratings .......................... [[32mSELECT 40[0m in 0.03s]
[0m14:20:19.364872 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:20:19.365973 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:19.366197 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:19.366343 [debug] [MainThread]: On master: BEGIN
[0m14:20:19.366473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:19.369881 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:20:19.370073 [debug] [MainThread]: On master: COMMIT
[0m14:20:19.370235 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:19.370368 [debug] [MainThread]: On master: COMMIT
[0m14:20:19.370836 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:20:19.370988 [debug] [MainThread]: On master: Close
[0m14:20:19.371413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:19.371600 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m14:20:19.371757 [debug] [MainThread]: Connection 'model.custom_postgres.film_ratings' was properly closed.
[0m14:20:19.372150 [info ] [MainThread]: 
[0m14:20:19.372453 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:20:19.372802 [debug] [MainThread]: Command end result
[0m14:20:19.377522 [info ] [MainThread]: 
[0m14:20:19.377751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:19.377922 [info ] [MainThread]: 
[0m14:20:19.378086 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:20:19.378306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d93d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d93dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d9e710>]}
[0m14:20:19.378507 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:37:17.874833 | 4fc9ae99-c076-498e-8264-bdc86312c351 ==============================
[0m14:37:17.874833 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:37:17.878833 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:37:17.879081 [debug] [MainThread]: Tracking: tracking
[0m14:37:17.892856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb725360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7257e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7253c0>]}
[0m14:37:17.902355 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:37:17.927909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m14:37:17.928318 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/film_rating_macro.sql
[0m14:37:17.928580 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/specific_movie.sql
[0m14:37:17.928861 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:37:17.955332 [debug] [MainThread]: 1603: static parser failed on example/specific_movie.sql
[0m14:37:17.970989 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/specific_movie.sql
[0m14:37:18.006395 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m14:37:18.011046 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m14:37:18.047446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e66e30>]}
[0m14:37:18.055647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7026e0>]}
[0m14:37:18.056014 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:37:18.056460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72d360>]}
[0m14:37:18.058073 [info ] [MainThread]: 
[0m14:37:18.059809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:18.061160 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:37:18.068860 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:37:18.069100 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:37:18.069312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:18.110506 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:37:18.111927 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:37:18.114572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:37:18.118878 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:37:18.119090 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:37:18.119284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:18.124351 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:37:18.124672 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:37:18.124902 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:37:18.126398 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:37:18.127461 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:37:18.128144 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:37:18.132894 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.133144 [debug] [MainThread]: On master: BEGIN
[0m14:37:18.133341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:37:18.138167 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:37:18.138446 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.138675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:37:18.141695 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:37:18.142536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e53520>]}
[0m14:37:18.142865 [debug] [MainThread]: On master: ROLLBACK
[0m14:37:18.143519 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.143764 [debug] [MainThread]: On master: BEGIN
[0m14:37:18.144854 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:37:18.145120 [debug] [MainThread]: On master: COMMIT
[0m14:37:18.145338 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.145537 [debug] [MainThread]: On master: COMMIT
[0m14:37:18.146146 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:37:18.146333 [debug] [MainThread]: On master: Close
[0m14:37:18.146835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:18.147175 [info ] [MainThread]: 
[0m14:37:18.158788 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:37:18.159148 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:37:18.159705 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:37:18.159992 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:37:18.161889 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:37:18.163180 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:37:18.160160 => 2025-01-01 14:37:18.163118
[0m14:37:18.163394 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:37:18.189755 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:37:18.190728 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:37:18.190906 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:37:18.191043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:18.196150 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:37:18.196343 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:37:18.196506 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:37:18.198250 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:37:18.202446 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:37:18.202660 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:37:18.204076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:37:18.205859 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:37:18.206022 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:37:18.206560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:37:18.220882 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:37:18.221098 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:37:18.221272 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:37:18.222168 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:37:18.225334 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:37:18.225538 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:37:18.226678 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:37:18.227518 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:37:18.163532 => 2025-01-01 14:37:18.227482
[0m14:37:18.227702 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:37:18.228278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8548be0>]}
[0m14:37:18.229052 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:37:18.230409 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:37:18.230673 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:37:18.230926 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:37:18.231357 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:37:18.231527 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:37:18.233236 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:37:18.233827 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:37:18.231666 => 2025-01-01 14:37:18.233793
[0m14:37:18.234020 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:37:18.237380 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:37:18.237901 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:37:18.238044 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:37:18.238178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:18.243256 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:37:18.243448 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:37:18.243639 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:37:18.245461 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:37:18.247472 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:37:18.247672 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:37:18.248228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:37:18.249982 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:37:18.250162 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:37:18.250693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:37:18.251908 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:37:18.252094 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:37:18.252216 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:37:18.252800 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:37:18.254213 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:37:18.254370 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:37:18.255312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:37:18.256158 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:37:18.234140 => 2025-01-01 14:37:18.256122
[0m14:37:18.256323 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:37:18.256885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e61cc0>]}
[0m14:37:18.257253 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m14:37:18.257583 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:37:18.257971 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:37:18.258258 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:37:18.258714 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:37:18.258917 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:37:18.260731 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:37:18.261253 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:37:18.259057 => 2025-01-01 14:37:18.261222
[0m14:37:18.261414 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:37:18.264098 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:37:18.264591 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:37:18.264726 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:37:18.264850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:18.269365 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:37:18.269669 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:37:18.269958 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:37:18.271852 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:37:18.274093 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:37:18.274343 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:37:18.275020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:37:18.276828 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:37:18.276991 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:37:18.277637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:37:18.279101 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:37:18.279268 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:37:18.279397 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:37:18.280093 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:37:18.281950 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:37:18.282169 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:37:18.283332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:37:18.284348 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:37:18.261526 => 2025-01-01 14:37:18.284291
[0m14:37:18.284545 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:37:18.285252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d68f0>]}
[0m14:37:18.285701 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m14:37:18.286070 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:37:18.287811 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:37:18.288095 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:37:18.288621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:37:18.288830 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:37:18.292390 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:37:18.293052 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:37:18.288966 => 2025-01-01 14:37:18.293009
[0m14:37:18.293231 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:37:18.296017 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:37:18.296496 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:37:18.296646 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:37:18.296783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:18.301583 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:37:18.301803 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:37:18.301983 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    -- 

WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id



WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:37:18.303103 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "WITH films_with_ratings"
LINE 38: WITH films_with_ratings AS (
         ^

[0m14:37:18.303340 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m14:37:18.304047 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:37:18.293355 => 2025-01-01 14:37:18.303997
[0m14:37:18.304265 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:37:18.306124 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "WITH films_with_ratings"
  LINE 38: WITH films_with_ratings AS (
           ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m14:37:18.306488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff841bcd0>]}
[0m14:37:18.306832 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m14:37:18.307246 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:37:18.307483 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:37:18.307800 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:37:18.308284 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:37:18.308482 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:37:18.310511 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:37:18.311197 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:37:18.308613 => 2025-01-01 14:37:18.311161
[0m14:37:18.311402 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:37:18.314090 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:37:18.314623 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:37:18.314787 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:37:18.314947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:18.319230 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:37:18.319404 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:37:18.319584 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:37:18.321759 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:37:18.323658 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:37:18.323880 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:37:18.324442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:37:18.325614 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:37:18.325797 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:37:18.325954 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:37:18.326545 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:37:18.327882 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:37:18.328048 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:37:18.328575 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:37:18.329363 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:37:18.311552 => 2025-01-01 14:37:18.329329
[0m14:37:18.329532 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:37:18.330048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc9ae99-c076-498e-8264-bdc86312c351', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8549180>]}
[0m14:37:18.330382 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m14:37:18.330806 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:37:18.331939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:37:18.332223 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.332390 [debug] [MainThread]: On master: BEGIN
[0m14:37:18.332530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:37:18.336252 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:37:18.336422 [debug] [MainThread]: On master: COMMIT
[0m14:37:18.336596 [debug] [MainThread]: Using postgres connection "master"
[0m14:37:18.336771 [debug] [MainThread]: On master: COMMIT
[0m14:37:18.337217 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:37:18.337413 [debug] [MainThread]: On master: Close
[0m14:37:18.337870 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:18.338047 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m14:37:18.338194 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:37:18.338683 [info ] [MainThread]: 
[0m14:37:18.338973 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:37:18.339364 [debug] [MainThread]: Command end result
[0m14:37:18.344884 [info ] [MainThread]: 
[0m14:37:18.345202 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:37:18.345445 [info ] [MainThread]: 
[0m14:37:18.345746 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:37:18.346015 [error] [MainThread]:   syntax error at or near "WITH films_with_ratings"
[0m14:37:18.346262 [error] [MainThread]:   LINE 38: WITH films_with_ratings AS (
[0m14:37:18.346487 [error] [MainThread]:            ^
[0m14:37:18.346778 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m14:37:18.347042 [info ] [MainThread]: 
[0m14:37:18.347333 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:37:18.347718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ea4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83de920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff85222c0>]}
[0m14:37:18.348019 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:39:53.940597 | e9cdf323-2f0c-405a-b740-a157e6609d11 ==============================
[0m14:39:53.940597 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:39:53.944417 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:39:53.944685 [debug] [MainThread]: Tracking: tracking
[0m14:39:53.958549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m14:39:53.968927 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:39:53.996348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:53.996883 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:39:54.053458 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m14:39:54.068016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m14:39:54.104720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e749d0>]}
[0m14:39:54.113216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7024d0>]}
[0m14:39:54.113592 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:39:54.113899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72f820>]}
[0m14:39:54.115529 [info ] [MainThread]: 
[0m14:39:54.117209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:54.118555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:39:54.126217 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:39:54.126429 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:39:54.126624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:54.167677 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:39:54.169099 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:39:54.171405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:39:54.175483 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:39:54.175773 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:39:54.175972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:54.181852 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:39:54.182076 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:39:54.182247 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:39:54.183625 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:39:54.184624 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:39:54.185226 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:39:54.189907 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:54.190158 [debug] [MainThread]: On master: BEGIN
[0m14:39:54.190381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:54.195383 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:39:54.195596 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:54.195792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:54.199036 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:39:54.199847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e12c20>]}
[0m14:39:54.200205 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:54.200801 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:54.200998 [debug] [MainThread]: On master: BEGIN
[0m14:39:54.201996 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:39:54.202183 [debug] [MainThread]: On master: COMMIT
[0m14:39:54.202394 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:54.202575 [debug] [MainThread]: On master: COMMIT
[0m14:39:54.203136 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:39:54.203331 [debug] [MainThread]: On master: Close
[0m14:39:54.203825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:54.204226 [info ] [MainThread]: 
[0m14:39:54.215982 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:39:54.216487 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:39:54.217139 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:39:54.217566 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:39:54.219691 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:39:54.221166 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:39:54.217826 => 2025-01-01 14:39:54.221100
[0m14:39:54.221433 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:39:54.248083 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:39:54.249097 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:39:54.249297 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:39:54.249514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:54.253655 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:39:54.253852 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:39:54.254028 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:39:54.255787 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:39:54.259967 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:39:54.260162 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:39:54.260833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:54.262582 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:39:54.262751 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:39:54.263287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:54.277203 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:39:54.277454 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:39:54.277636 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:39:54.278660 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:39:54.282096 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:39:54.282317 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:39:54.283773 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:39:54.284718 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:39:54.221601 => 2025-01-01 14:39:54.284678
[0m14:39:54.284910 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:39:54.285528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8527af0>]}
[0m14:39:54.286299 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:39:54.287786 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:39:54.288070 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:39:54.288348 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:39:54.288797 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:39:54.288971 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:39:54.290686 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:39:54.291260 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:39:54.289090 => 2025-01-01 14:39:54.291217
[0m14:39:54.291485 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:39:54.294785 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:39:54.295325 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:39:54.295483 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:39:54.295669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:54.299383 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:39:54.299562 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:39:54.299696 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:39:54.301113 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:39:54.302969 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:39:54.303161 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:39:54.304833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:54.306687 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:39:54.306871 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:39:54.307405 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:54.308642 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:39:54.308801 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:39:54.308949 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:39:54.309552 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:39:54.310904 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:39:54.311067 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:39:54.311997 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:39:54.312797 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:39:54.291621 => 2025-01-01 14:39:54.312763
[0m14:39:54.312958 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:39:54.313450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83b62c0>]}
[0m14:39:54.313803 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.02s]
[0m14:39:54.314115 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:39:54.314484 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:39:54.314737 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:39:54.315163 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:39:54.315341 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:39:54.317023 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:39:54.317555 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:39:54.315457 => 2025-01-01 14:39:54.317524
[0m14:39:54.317727 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:39:54.320374 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:39:54.320845 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:39:54.320983 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:39:54.321112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:54.325619 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:39:54.325793 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:39:54.325925 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:39:54.327724 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:39:54.329552 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:39:54.329780 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:39:54.330491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:54.332136 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:39:54.332299 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:39:54.332812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:54.334110 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:39:54.334316 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:39:54.334448 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:39:54.335035 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:39:54.336327 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:39:54.336486 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:39:54.337492 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:39:54.338242 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:39:54.317846 => 2025-01-01 14:39:54.338211
[0m14:39:54.338416 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:39:54.338888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8566f20>]}
[0m14:39:54.339201 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m14:39:54.339505 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:39:54.340810 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:39:54.341198 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:39:54.341688 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:39:54.341907 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:39:54.345147 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:39:54.345751 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:39:54.342052 => 2025-01-01 14:39:54.345714
[0m14:39:54.345924 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:39:54.348528 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:39:54.349049 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:39:54.349207 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:39:54.349407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:54.354329 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:39:54.354583 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:39:54.354758 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id

-- 

WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m14:39:54.355795 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "WITH films_with_ratings"
LINE 36: WITH films_with_ratings AS (
         ^

[0m14:39:54.355977 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m14:39:54.356669 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:39:54.346040 => 2025-01-01 14:39:54.356621
[0m14:39:54.356854 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:39:54.358492 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "WITH films_with_ratings"
  LINE 36: WITH films_with_ratings AS (
           ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m14:39:54.358822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83fbac0>]}
[0m14:39:54.359173 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m14:39:54.359575 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:39:54.359811 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:39:54.360110 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:39:54.360540 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:39:54.360726 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:39:54.362659 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:39:54.363312 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:39:54.360856 => 2025-01-01 14:39:54.363266
[0m14:39:54.363528 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:39:54.366145 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:39:54.366618 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:39:54.366769 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:39:54.366906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:54.371907 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:39:54.372072 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:39:54.372215 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:39:54.374019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:39:54.375857 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:39:54.376059 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:39:54.376751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:39:54.377917 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:39:54.378095 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:39:54.378229 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:39:54.378844 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:39:54.380193 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:39:54.380363 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:39:54.380825 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:39:54.381649 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:39:54.363688 => 2025-01-01 14:39:54.381619
[0m14:39:54.381837 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:39:54.382353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9cdf323-2f0c-405a-b740-a157e6609d11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83ed2d0>]}
[0m14:39:54.382661 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m14:39:54.382931 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:39:54.384113 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:54.384317 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:54.384462 [debug] [MainThread]: On master: BEGIN
[0m14:39:54.384607 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:54.388197 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:39:54.388467 [debug] [MainThread]: On master: COMMIT
[0m14:39:54.388643 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:54.388785 [debug] [MainThread]: On master: COMMIT
[0m14:39:54.389250 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:39:54.389445 [debug] [MainThread]: On master: Close
[0m14:39:54.389900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:54.390138 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m14:39:54.390321 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:39:54.390769 [info ] [MainThread]: 
[0m14:39:54.391063 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:39:54.391512 [debug] [MainThread]: Command end result
[0m14:39:54.396776 [info ] [MainThread]: 
[0m14:39:54.397112 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:39:54.397367 [info ] [MainThread]: 
[0m14:39:54.397601 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:39:54.397817 [error] [MainThread]:   syntax error at or near "WITH films_with_ratings"
[0m14:39:54.398027 [error] [MainThread]:   LINE 36: WITH films_with_ratings AS (
[0m14:39:54.398230 [error] [MainThread]:            ^
[0m14:39:54.398462 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m14:39:54.398669 [info ] [MainThread]: 
[0m14:39:54.398884 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:39:54.399141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84cb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7211e0>]}
[0m14:39:54.399367 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:44:51.714594 | 3c9134af-03f9-488d-b0dc-29e573f2dd45 ==============================
[0m14:44:51.714594 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:44:51.718395 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:44:51.718632 [debug] [MainThread]: Tracking: tracking
[0m14:44:51.732451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m14:44:51.743069 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:44:51.769182 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m14:44:51.769644 [debug] [MainThread]: Partial parsing: deleted file: custom_postgres://macros/film_rating_macro.sql
[0m14:44:51.769879 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:44:51.826809 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m14:44:51.874838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84cbeb0>]}
[0m14:44:51.883820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702590>]}
[0m14:44:51.884159 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:44:51.884487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7024d0>]}
[0m14:44:51.886039 [info ] [MainThread]: 
[0m14:44:51.887933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:51.889345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:44:51.897212 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:44:51.897483 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:44:51.897666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:51.939047 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:44:51.940461 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:44:51.942700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:44:51.946926 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:44:51.947122 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:44:51.947283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:51.951786 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:44:51.951981 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:44:51.952132 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:44:51.953410 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:44:51.954391 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:44:51.955086 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:44:51.959589 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:51.959827 [debug] [MainThread]: On master: BEGIN
[0m14:44:51.960017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:51.964322 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:44:51.964530 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:51.964709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:51.968144 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:44:51.969015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702c20>]}
[0m14:44:51.969425 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:51.970078 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:51.970267 [debug] [MainThread]: On master: BEGIN
[0m14:44:51.971257 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:44:51.971563 [debug] [MainThread]: On master: COMMIT
[0m14:44:51.971769 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:51.971948 [debug] [MainThread]: On master: COMMIT
[0m14:44:51.972495 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:44:51.972686 [debug] [MainThread]: On master: Close
[0m14:44:51.973181 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:51.973520 [info ] [MainThread]: 
[0m14:44:51.986144 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:44:51.986537 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:44:51.987110 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:44:51.987424 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:44:51.989586 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:44:51.990920 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:44:51.987610 => 2025-01-01 14:44:51.990863
[0m14:44:51.991134 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:44:52.018258 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:44:52.019186 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:44:52.019368 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:44:52.019547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:52.024976 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:44:52.025158 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:44:52.025310 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:44:52.027157 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:44:52.031495 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:44:52.031750 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:44:52.032818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:44:52.034568 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:44:52.034740 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:44:52.035278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:44:52.049732 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:44:52.049950 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:44:52.050130 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:44:52.051002 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:44:52.054246 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:44:52.054435 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:44:52.055702 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:44:52.056563 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:44:51.991293 => 2025-01-01 14:44:52.056514
[0m14:44:52.056743 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:44:52.057389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff856a860>]}
[0m14:44:52.058179 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:44:52.059757 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:44:52.060042 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:44:52.060344 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:44:52.060820 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:44:52.061049 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:44:52.062778 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:44:52.063421 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:44:52.061186 => 2025-01-01 14:44:52.063381
[0m14:44:52.063613 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:44:52.066516 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:44:52.066987 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:44:52.067134 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:44:52.067265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:52.070860 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:44:52.071023 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:44:52.071171 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:44:52.072836 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:44:52.075319 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:44:52.075496 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:44:52.076179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:44:52.077961 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:44:52.078132 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:44:52.078674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:44:52.080027 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:44:52.080184 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:44:52.080308 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:44:52.080856 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:44:52.082254 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:44:52.082455 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:44:52.083318 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:44:52.084073 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:44:52.063744 => 2025-01-01 14:44:52.084043
[0m14:44:52.084242 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:44:52.084745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e8ccd0>]}
[0m14:44:52.085073 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.02s]
[0m14:44:52.085374 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:44:52.085712 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:44:52.085957 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:44:52.086420 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:44:52.086608 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:44:52.088350 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:44:52.088919 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:44:52.086741 => 2025-01-01 14:44:52.088885
[0m14:44:52.089089 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:44:52.091832 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:44:52.092281 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:44:52.092421 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:44:52.092543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:52.096132 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:44:52.096305 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:44:52.096438 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:44:52.097996 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:44:52.099868 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:44:52.100060 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:44:52.100737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:44:52.102449 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:44:52.102596 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:44:52.103064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:44:52.104452 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:44:52.104609 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:44:52.104734 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:44:52.105322 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:44:52.106654 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:44:52.106813 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:44:52.107875 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:44:52.108734 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:44:52.089199 => 2025-01-01 14:44:52.108699
[0m14:44:52.108896 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:44:52.109404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83ccf40>]}
[0m14:44:52.109775 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m14:44:52.110057 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:44:52.111535 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:44:52.111787 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:44:52.112238 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:44:52.112439 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:44:52.114872 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:44:52.115441 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:44:52.112580 => 2025-01-01 14:44:52.115404
[0m14:44:52.115602 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:44:52.119114 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:44:52.119576 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:44:52.119713 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:44:52.119838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:52.124523 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:44:52.124709 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:44:52.124868 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:44:52.128409 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:44:52.130598 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:44:52.130781 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m14:44:52.131352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:44:52.132633 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:44:52.132795 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:44:52.132947 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:44:52.133620 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:44:52.134936 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:44:52.135107 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m14:44:52.135587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:44:52.136402 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:44:52.115711 => 2025-01-01 14:44:52.136373
[0m14:44:52.136576 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:44:52.137142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e3610>]}
[0m14:44:52.137484 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.03s]
[0m14:44:52.137899 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:44:52.138375 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:44:52.138670 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:44:52.139113 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:44:52.139295 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:44:52.141309 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:44:52.141892 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:44:52.139445 => 2025-01-01 14:44:52.141858
[0m14:44:52.142077 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:44:52.144871 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:44:52.145397 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:44:52.145544 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:44:52.145666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:52.149398 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:44:52.149578 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:44:52.149732 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:44:52.151479 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:44:52.153347 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:44:52.153540 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:44:52.154239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:44:52.155539 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:44:52.155704 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:44:52.155851 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:44:52.156541 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:44:52.157978 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:44:52.158147 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:44:52.158661 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:44:52.159424 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:44:52.142198 => 2025-01-01 14:44:52.159394
[0m14:44:52.159600 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:44:52.160088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c9134af-03f9-488d-b0dc-29e573f2dd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e2e90>]}
[0m14:44:52.160435 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m14:44:52.160732 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:44:52.161752 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:52.161969 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:52.162115 [debug] [MainThread]: On master: BEGIN
[0m14:44:52.162247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:52.165848 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:44:52.166030 [debug] [MainThread]: On master: COMMIT
[0m14:44:52.166172 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:52.166330 [debug] [MainThread]: On master: COMMIT
[0m14:44:52.166830 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:44:52.167013 [debug] [MainThread]: On master: Close
[0m14:44:52.167452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:52.167621 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m14:44:52.167762 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:44:52.168192 [info ] [MainThread]: 
[0m14:44:52.168517 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:44:52.169019 [debug] [MainThread]: Command end result
[0m14:44:52.174551 [info ] [MainThread]: 
[0m14:44:52.174830 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:52.175014 [info ] [MainThread]: 
[0m14:44:52.175224 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:44:52.175526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e17e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84c8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff856bdf0>]}
[0m14:44:52.175748 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:47:16.114638 | 64479d16-77af-4570-a864-6df66a3142e8 ==============================
[0m14:47:16.114638 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:47:16.118427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:47:16.118715 [debug] [MainThread]: Tracking: tracking
[0m14:47:16.132063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m14:47:16.141735 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:47:16.168009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:47:16.168264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:47:16.175515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54e20>]}
[0m14:47:16.184666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a440>]}
[0m14:47:16.184952 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:47:16.185234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a4a0>]}
[0m14:47:16.186809 [info ] [MainThread]: 
[0m14:47:16.188571 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:47:16.192467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:47:16.203285 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:47:16.204705 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:47:16.205682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:16.249904 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:47:16.251519 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:47:16.254054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:47:16.258205 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:47:16.258428 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:47:16.258665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:16.264716 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:47:16.264946 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:47:16.265133 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:47:16.266649 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:47:16.267614 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:47:16.268295 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:47:16.272679 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:16.272956 [debug] [MainThread]: On master: BEGIN
[0m14:47:16.273154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:47:16.277799 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:47:16.278110 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:16.278350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:47:16.282322 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:47:16.283283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e890f0>]}
[0m14:47:16.283634 [debug] [MainThread]: On master: ROLLBACK
[0m14:47:16.284240 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:16.284421 [debug] [MainThread]: On master: BEGIN
[0m14:47:16.285417 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:47:16.285661 [debug] [MainThread]: On master: COMMIT
[0m14:47:16.285848 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:16.286031 [debug] [MainThread]: On master: COMMIT
[0m14:47:16.286601 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:47:16.286799 [debug] [MainThread]: On master: Close
[0m14:47:16.287298 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:16.287587 [info ] [MainThread]: 
[0m14:47:16.300714 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:47:16.301233 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:47:16.301937 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:47:16.302181 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:47:16.304356 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:47:16.305771 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:47:16.302374 => 2025-01-01 14:47:16.305698
[0m14:47:16.306011 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:47:16.333492 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:47:16.334543 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:47:16.334745 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:47:16.334950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:16.339094 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:47:16.339273 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:47:16.339405 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:47:16.341385 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:47:16.345525 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:47:16.345736 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:47:16.346467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:47:16.348184 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:47:16.348342 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:47:16.348897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:47:16.363523 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:47:16.363797 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:47:16.363998 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:47:16.365014 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:47:16.368158 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:47:16.368337 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:47:16.369583 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:47:16.370515 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:47:16.306167 => 2025-01-01 14:47:16.370474
[0m14:47:16.370711 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:47:16.371412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d19180>]}
[0m14:47:16.372481 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:47:16.373771 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:47:16.374071 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:47:16.374349 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:47:16.374854 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:47:16.375065 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:47:16.376894 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:47:16.377513 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:47:16.375189 => 2025-01-01 14:47:16.377471
[0m14:47:16.377711 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:47:16.380625 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:47:16.381117 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:47:16.381250 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:47:16.381376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:16.385246 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:47:16.385431 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:47:16.385587 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:47:16.387006 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:47:16.388868 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:47:16.389073 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:47:16.389785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:47:16.391529 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:47:16.391706 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:47:16.392250 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:47:16.393770 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:47:16.393940 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:47:16.394076 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:47:16.394677 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:47:16.396673 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:47:16.396834 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:47:16.397743 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:47:16.398511 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:47:16.377837 => 2025-01-01 14:47:16.398480
[0m14:47:16.398680 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:47:16.399209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d8c100>]}
[0m14:47:16.399617 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.02s]
[0m14:47:16.399890 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:47:16.400245 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:47:16.400520 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:47:16.400988 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:47:16.401197 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:47:16.402942 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:47:16.403488 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:47:16.401319 => 2025-01-01 14:47:16.403455
[0m14:47:16.403661 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:47:16.406391 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:47:16.406879 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:47:16.407037 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:47:16.407161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:16.413350 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:47:16.413648 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:47:16.413850 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:47:16.415637 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:47:16.417519 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:47:16.417693 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:47:16.418244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:47:16.419842 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:47:16.419988 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:47:16.420466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:47:16.421848 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:47:16.422015 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:47:16.422142 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:47:16.422814 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:47:16.424199 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:47:16.424358 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:47:16.425469 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:47:16.426298 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:47:16.403774 => 2025-01-01 14:47:16.426261
[0m14:47:16.426488 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:47:16.427089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d86e60>]}
[0m14:47:16.427569 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m14:47:16.427988 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:47:16.429587 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:47:16.429897 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:47:16.430411 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:47:16.430628 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:47:16.433153 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:47:16.433774 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:47:16.430769 => 2025-01-01 14:47:16.433735
[0m14:47:16.433969 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:47:16.436994 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:47:16.437526 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:47:16.437671 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:47:16.437807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:16.441679 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:47:16.441870 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:47:16.442013 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:47:16.445883 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:47:16.447801 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:47:16.447979 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m14:47:16.448482 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:47:16.449713 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:47:16.449878 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:47:16.450014 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:47:16.450607 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:47:16.451972 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:47:16.452898 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m14:47:16.453448 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:47:16.454199 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:47:16.434093 => 2025-01-01 14:47:16.454168
[0m14:47:16.454360 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:47:16.454874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839d270>]}
[0m14:47:16.455203 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.02s]
[0m14:47:16.455500 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:47:16.455846 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:47:16.456108 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:47:16.456540 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:47:16.456699 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:47:16.458623 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:47:16.459334 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:47:16.456813 => 2025-01-01 14:47:16.459284
[0m14:47:16.459567 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:47:16.462210 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:47:16.462657 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:47:16.462789 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:47:16.462916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:16.475267 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:47:16.475547 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:47:16.475752 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:47:16.477943 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:47:16.479901 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:47:16.480063 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:47:16.480584 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:47:16.481921 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:47:16.482086 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:47:16.482210 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:47:16.482827 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:47:16.484121 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:47:16.484279 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:47:16.484774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:47:16.485509 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:47:16.459713 => 2025-01-01 14:47:16.485477
[0m14:47:16.485669 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:47:16.486168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64479d16-77af-4570-a864-6df66a3142e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d9d4b0>]}
[0m14:47:16.486494 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.03s]
[0m14:47:16.486791 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:47:16.487801 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:47:16.488013 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:16.488155 [debug] [MainThread]: On master: BEGIN
[0m14:47:16.488286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:47:16.492778 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:47:16.493055 [debug] [MainThread]: On master: COMMIT
[0m14:47:16.493235 [debug] [MainThread]: Using postgres connection "master"
[0m14:47:16.493384 [debug] [MainThread]: On master: COMMIT
[0m14:47:16.493896 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:47:16.494090 [debug] [MainThread]: On master: Close
[0m14:47:16.494696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:16.494990 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:47:16.495512 [info ] [MainThread]: 
[0m14:47:16.495812 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:47:16.496318 [debug] [MainThread]: Command end result
[0m14:47:16.502023 [info ] [MainThread]: 
[0m14:47:16.502356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:47:16.502628 [info ] [MainThread]: 
[0m14:47:16.502857 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:47:16.503155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ea45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e94670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d9e380>]}
[0m14:47:16.503400 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:49:14.898152 | de6192e3-76e5-416b-8fac-78f040bce3cd ==============================
[0m14:49:14.898152 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:49:14.901471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:49:14.901709 [debug] [MainThread]: Tracking: tracking
[0m14:49:14.915598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m14:49:14.925699 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:49:14.952108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:49:14.952525 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/film_rating_macro.sql
[0m14:49:14.952828 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:49:15.010163 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m14:49:15.021967 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m14:49:15.058674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e70760>]}
[0m14:49:15.067038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702470>]}
[0m14:49:15.067406 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:49:15.067703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72e3b0>]}
[0m14:49:15.069117 [info ] [MainThread]: 
[0m14:49:15.070721 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:15.072090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:49:15.079607 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:49:15.079878 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:49:15.080091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:15.123016 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:49:15.124682 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:49:15.127299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:49:15.131602 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:49:15.131843 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:49:15.132059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:15.137205 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:49:15.137442 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:49:15.137655 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:49:15.139236 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:49:15.140332 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:49:15.141023 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:49:15.145624 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:15.145872 [debug] [MainThread]: On master: BEGIN
[0m14:49:15.146083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:15.150585 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:49:15.150797 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:15.151033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:15.154686 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:49:15.155476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e12a10>]}
[0m14:49:15.155800 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:15.156452 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:15.156635 [debug] [MainThread]: On master: BEGIN
[0m14:49:15.157658 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:49:15.157865 [debug] [MainThread]: On master: COMMIT
[0m14:49:15.158074 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:15.158252 [debug] [MainThread]: On master: COMMIT
[0m14:49:15.158826 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:49:15.159025 [debug] [MainThread]: On master: Close
[0m14:49:15.159534 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:15.159864 [info ] [MainThread]: 
[0m14:49:15.172006 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:49:15.172432 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:49:15.173043 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:49:15.173353 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:49:15.175253 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:49:15.177141 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:49:15.173544 => 2025-01-01 14:49:15.177063
[0m14:49:15.177361 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:49:15.204612 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:49:15.205563 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:49:15.205748 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:49:15.205955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.209971 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:49:15.210142 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:49:15.210293 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:49:15.212237 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:49:15.216482 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:49:15.216701 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:49:15.218159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:49:15.219926 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:49:15.220096 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:49:15.220648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:49:15.234934 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:49:15.235148 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:49:15.235317 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:49:15.236157 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:49:15.239462 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:49:15.239632 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:49:15.240839 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:49:15.241710 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:49:15.177571 => 2025-01-01 14:49:15.241670
[0m14:49:15.241899 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:49:15.242470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8523af0>]}
[0m14:49:15.243217 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:49:15.244835 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:49:15.245126 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:49:15.245391 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:49:15.245889 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:49:15.246103 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:49:15.247815 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:49:15.248403 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:49:15.246232 => 2025-01-01 14:49:15.248365
[0m14:49:15.248605 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:49:15.252242 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:49:15.252789 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:49:15.252968 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:49:15.253100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.257129 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:49:15.257330 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:49:15.257501 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:49:15.259031 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:49:15.261013 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:49:15.261186 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:49:15.261821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:49:15.263542 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:49:15.263704 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:49:15.264332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:49:15.265710 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:49:15.265888 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:49:15.266020 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:49:15.266661 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:49:15.268753 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:49:15.269034 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:49:15.270269 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:49:15.271272 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:49:15.248737 => 2025-01-01 14:49:15.271233
[0m14:49:15.271456 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:49:15.272059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83be080>]}
[0m14:49:15.272423 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m14:49:15.272756 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:49:15.273090 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:49:15.273453 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:49:15.273980 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:49:15.274212 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:49:15.276205 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:49:15.276800 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:49:15.274338 => 2025-01-01 14:49:15.276763
[0m14:49:15.276985 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:49:15.279722 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:49:15.280244 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:49:15.280390 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:49:15.280528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.284905 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:49:15.285170 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:49:15.285345 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:49:15.287303 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:49:15.289259 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:49:15.289584 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:49:15.290287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:49:15.292073 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:49:15.292243 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:49:15.292735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:49:15.294092 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:49:15.294279 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:49:15.294426 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:49:15.295038 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:49:15.296452 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:49:15.296614 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:49:15.297635 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:49:15.298457 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:49:15.277100 => 2025-01-01 14:49:15.298423
[0m14:49:15.298651 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:49:15.299193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e69000>]}
[0m14:49:15.299590 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m14:49:15.299957 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:49:15.301486 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:49:15.301753 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:49:15.302300 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:49:15.302505 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:49:15.306023 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:49:15.306665 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:49:15.302627 => 2025-01-01 14:49:15.306624
[0m14:49:15.306866 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:49:15.309488 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:49:15.309992 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:49:15.310140 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:49:15.310268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.314128 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:49:15.314301 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:49:15.314440 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id

--

WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"  -- Using dbt's ref function to reference the films table
),

films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m14:49:15.315441 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "WITH films_with_ratings"
LINE 36: WITH films_with_ratings AS (
         ^

[0m14:49:15.315673 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: ROLLBACK
[0m14:49:15.316308 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:49:15.306991 => 2025-01-01 14:49:15.316265
[0m14:49:15.316506 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:49:15.318304 [debug] [Thread-1 (]: Database Error in model film_ratings (models/example/film_ratings.sql)
  syntax error at or near "WITH films_with_ratings"
  LINE 36: WITH films_with_ratings AS (
           ^
  compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m14:49:15.318714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8403af0>]}
[0m14:49:15.319280 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.02s]
[0m14:49:15.319577 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:49:15.319828 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:49:15.320141 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:49:15.320575 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:49:15.320757 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:49:15.322693 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:49:15.323532 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:49:15.320888 => 2025-01-01 14:49:15.323495
[0m14:49:15.323748 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:49:15.326775 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:49:15.327447 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:49:15.327623 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:49:15.327776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:15.332417 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:49:15.332652 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:49:15.332839 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:49:15.334876 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:49:15.336990 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:49:15.337185 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:49:15.337734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:49:15.338979 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:49:15.339218 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:49:15.339374 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:49:15.339977 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:49:15.341343 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:49:15.341495 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:49:15.342000 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:49:15.342852 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:49:15.323950 => 2025-01-01 14:49:15.342815
[0m14:49:15.343026 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:49:15.343546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de6192e3-76e5-416b-8fac-78f040bce3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83f1ba0>]}
[0m14:49:15.343877 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m14:49:15.344232 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:49:15.345370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:15.345558 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:15.345695 [debug] [MainThread]: On master: BEGIN
[0m14:49:15.345842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:15.349397 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:49:15.349608 [debug] [MainThread]: On master: COMMIT
[0m14:49:15.349780 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:15.349945 [debug] [MainThread]: On master: COMMIT
[0m14:49:15.350383 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:49:15.350570 [debug] [MainThread]: On master: Close
[0m14:49:15.351016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:15.351206 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m14:49:15.351344 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:49:15.351712 [info ] [MainThread]: 
[0m14:49:15.352041 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:49:15.352405 [debug] [MainThread]: Command end result
[0m14:49:15.357709 [info ] [MainThread]: 
[0m14:49:15.358036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:49:15.358269 [info ] [MainThread]: 
[0m14:49:15.358473 [error] [MainThread]: [33mDatabase Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:49:15.358743 [error] [MainThread]:   syntax error at or near "WITH films_with_ratings"
[0m14:49:15.359047 [error] [MainThread]:   LINE 36: WITH films_with_ratings AS (
[0m14:49:15.359316 [error] [MainThread]:            ^
[0m14:49:15.359563 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_ratings.sql
[0m14:49:15.359797 [info ] [MainThread]: 
[0m14:49:15.360060 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:49:15.360410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e6b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb720d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7206d0>]}
[0m14:49:15.360682 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:50:56.889697 | 7255043f-486c-489b-9f2e-ed748c9373e3 ==============================
[0m14:50:56.889697 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:50:56.893981 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:50:56.894602 [debug] [MainThread]: Tracking: tracking
[0m14:50:56.913994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m14:50:56.939826 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:50:56.992722 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m14:50:56.993430 [debug] [MainThread]: Partial parsing: deleted file: custom_postgres://macros/film_rating_macro.sql
[0m14:50:57.050856 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m14:50:57.066695 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m14:50:57.109751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54d30>]}
[0m14:50:57.119316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7025c0>]}
[0m14:50:57.119688 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:50:57.119993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702500>]}
[0m14:50:57.121784 [info ] [MainThread]: 
[0m14:50:57.123661 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:57.125178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:50:57.133938 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:50:57.134308 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:50:57.134615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:57.178523 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:50:57.180789 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:50:57.183673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:50:57.188376 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:50:57.188660 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:50:57.188869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:57.195168 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:50:57.195518 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:50:57.195798 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:50:57.197591 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:50:57.198915 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:50:57.199645 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:50:57.204779 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:57.205083 [debug] [MainThread]: On master: BEGIN
[0m14:50:57.205308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:57.210746 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:50:57.211051 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:57.211289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:50:57.215106 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:50:57.216051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e7e8f0>]}
[0m14:50:57.216443 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:57.217092 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:57.217291 [debug] [MainThread]: On master: BEGIN
[0m14:50:57.218423 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:50:57.218709 [debug] [MainThread]: On master: COMMIT
[0m14:50:57.218929 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:57.219120 [debug] [MainThread]: On master: COMMIT
[0m14:50:57.219781 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:50:57.220006 [debug] [MainThread]: On master: Close
[0m14:50:57.220548 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:57.220855 [info ] [MainThread]: 
[0m14:50:57.234529 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:50:57.235073 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:50:57.235806 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:50:57.236142 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:50:57.238462 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:50:57.240728 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:50:57.236412 => 2025-01-01 14:50:57.240637
[0m14:50:57.241013 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:50:57.270266 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:50:57.271522 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:50:57.271740 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:50:57.271903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:57.277879 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:50:57.278203 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:50:57.278419 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:50:57.281221 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:50:57.286473 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:50:57.286788 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:50:57.287605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:50:57.289667 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:50:57.289847 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:50:57.290430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:50:57.306618 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:50:57.306943 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:50:57.307098 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:50:57.308134 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:50:57.311747 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:50:57.311930 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:50:57.313274 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:50:57.314423 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:50:57.241240 => 2025-01-01 14:50:57.314369
[0m14:50:57.314713 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:50:57.315424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8589090>]}
[0m14:50:57.316245 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m14:50:57.317940 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:50:57.318285 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:50:57.318611 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:50:57.319129 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:50:57.319332 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:50:57.321328 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:50:57.322035 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:50:57.319464 => 2025-01-01 14:50:57.321988
[0m14:50:57.322258 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:50:57.326099 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:50:57.326727 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:50:57.326905 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:50:57.327084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:57.332739 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:50:57.332972 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:50:57.333140 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:50:57.336338 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:50:57.338350 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:50:57.338544 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:50:57.339217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:50:57.341041 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:50:57.341217 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:50:57.341897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:50:57.343421 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:50:57.343607 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:50:57.343747 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:50:57.344417 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:50:57.345841 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:50:57.346005 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:50:57.347056 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:50:57.347998 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:50:57.322391 => 2025-01-01 14:50:57.347953
[0m14:50:57.348214 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:50:57.348821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d1870>]}
[0m14:50:57.349204 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m14:50:57.349537 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:50:57.349793 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:50:57.350205 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:50:57.350710 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:50:57.350938 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:50:57.352852 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:50:57.353491 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:50:57.351060 => 2025-01-01 14:50:57.353438
[0m14:50:57.353673 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:50:57.356633 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:50:57.357322 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:50:57.357497 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:50:57.357644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:57.362290 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:50:57.362465 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:50:57.362621 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:50:57.364296 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:50:57.366413 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:50:57.366658 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:50:57.367495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:50:57.369340 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:50:57.369537 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:50:57.370072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:50:57.371615 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:50:57.371787 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:50:57.371924 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:50:57.372623 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:50:57.374161 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:50:57.374364 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:50:57.375550 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:50:57.376386 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:50:57.353794 => 2025-01-01 14:50:57.376346
[0m14:50:57.376573 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:50:57.377120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d38b0>]}
[0m14:50:57.377523 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m14:50:57.377845 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:50:57.379325 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:50:57.379570 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:50:57.380124 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:50:57.380348 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:50:57.384501 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:50:57.380514 => 2025-01-01 14:50:57.384442
[0m14:50:57.386083 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:57.386350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83df6d0>]}
[0m14:50:57.386638 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.01s]
[0m14:50:57.386925 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:50:57.387163 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:50:57.387464 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:50:57.388010 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:50:57.388203 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:50:57.390264 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:50:57.391066 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:50:57.388328 => 2025-01-01 14:50:57.391028
[0m14:50:57.391297 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:50:57.394056 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:50:57.394552 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:50:57.394700 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:50:57.394832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:57.401586 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:50:57.401862 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:50:57.402245 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:50:57.404634 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:50:57.406798 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:50:57.407051 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:50:57.407728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:50:57.409156 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:50:57.409339 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:50:57.409485 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:50:57.410142 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:50:57.411636 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:50:57.411799 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:50:57.412360 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:50:57.413163 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:50:57.391471 => 2025-01-01 14:50:57.413125
[0m14:50:57.413331 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:50:57.413963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7255043f-486c-489b-9f2e-ed748c9373e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d7010>]}
[0m14:50:57.414362 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.03s]
[0m14:50:57.414757 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:50:57.416054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:57.416343 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:57.416550 [debug] [MainThread]: On master: BEGIN
[0m14:50:57.416714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:57.421350 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:50:57.421600 [debug] [MainThread]: On master: COMMIT
[0m14:50:57.421790 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:57.421972 [debug] [MainThread]: On master: COMMIT
[0m14:50:57.422491 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:50:57.422662 [debug] [MainThread]: On master: Close
[0m14:50:57.423165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:57.423399 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:50:57.424053 [info ] [MainThread]: 
[0m14:50:57.424484 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:50:57.424971 [debug] [MainThread]: Command end result
[0m14:50:57.430902 [info ] [MainThread]: 
[0m14:50:57.431727 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:57.432090 [info ] [MainThread]: 
[0m14:50:57.432352 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:50:57.432662 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:50:57.432883 [info ] [MainThread]: 
[0m14:50:57.433163 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:50:57.433497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72ddb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72dd80>]}
[0m14:50:57.433768 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:52:56.991230 | e59645e6-0a2e-45a6-a342-75040d0f805d ==============================
[0m14:52:56.991230 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:52:56.995190 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:52:56.995425 [debug] [MainThread]: Tracking: tracking
[0m14:52:57.009678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m14:52:57.019859 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:52:57.045728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:57.046247 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:52:57.101969 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m14:52:57.115880 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m14:52:57.153352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84bfeb0>]}
[0m14:52:57.161736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7024a0>]}
[0m14:52:57.162314 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:52:57.162656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72e140>]}
[0m14:52:57.164153 [info ] [MainThread]: 
[0m14:52:57.166016 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:57.167497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:52:57.175744 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:52:57.176016 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:52:57.176310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:57.218377 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:52:57.219955 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:52:57.222473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:52:57.226732 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:52:57.226970 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:52:57.227204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:57.232349 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:52:57.232573 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:52:57.232765 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:52:57.234172 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:52:57.235170 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:52:57.235732 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:52:57.240184 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:57.240481 [debug] [MainThread]: On master: BEGIN
[0m14:52:57.240667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:57.245310 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:52:57.245545 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:57.245736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:57.248961 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:52:57.249744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e168c0>]}
[0m14:52:57.250054 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:57.250685 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:57.250865 [debug] [MainThread]: On master: BEGIN
[0m14:52:57.252098 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:52:57.252431 [debug] [MainThread]: On master: COMMIT
[0m14:52:57.252658 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:57.252846 [debug] [MainThread]: On master: COMMIT
[0m14:52:57.253450 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:52:57.253646 [debug] [MainThread]: On master: Close
[0m14:52:57.254167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:57.254519 [info ] [MainThread]: 
[0m14:52:57.267029 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:52:57.267476 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:52:57.268079 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:52:57.268506 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:52:57.270435 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:52:57.272032 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:52:57.268721 => 2025-01-01 14:52:57.271950
[0m14:52:57.272292 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:52:57.299361 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:52:57.300339 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:52:57.300530 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:52:57.300704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:57.305575 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:52:57.305749 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:52:57.305889 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:52:57.307942 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:52:57.312077 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:52:57.312251 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:52:57.313260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:52:57.315001 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:52:57.315162 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:52:57.315653 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:52:57.329844 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:52:57.330078 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:52:57.330252 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:52:57.331215 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:52:57.334493 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:52:57.334663 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:52:57.335933 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:52:57.336770 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:52:57.272470 => 2025-01-01 14:52:57.336727
[0m14:52:57.336960 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:52:57.337531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702680>]}
[0m14:52:57.338321 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:52:57.339922 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:52:57.340287 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:52:57.340599 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:52:57.341102 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:52:57.341293 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:52:57.343042 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:52:57.343606 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:52:57.341415 => 2025-01-01 14:52:57.343575
[0m14:52:57.343768 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:52:57.347206 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:52:57.347708 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:52:57.347852 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:52:57.348002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:57.353309 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:52:57.353535 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:52:57.353697 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:52:57.355434 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:52:57.357428 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:52:57.357593 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:52:57.358161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:52:57.359889 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:52:57.360067 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:52:57.360635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:52:57.361957 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:52:57.362118 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:52:57.362242 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:52:57.362880 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:52:57.364202 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:52:57.364354 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:52:57.365248 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:52:57.366026 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:52:57.343876 => 2025-01-01 14:52:57.365992
[0m14:52:57.366193 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:52:57.366735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7027d0>]}
[0m14:52:57.367224 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m14:52:57.367757 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:52:57.368008 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:52:57.368272 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:52:57.368696 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:52:57.368864 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:52:57.370678 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:52:57.371226 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:52:57.368994 => 2025-01-01 14:52:57.371194
[0m14:52:57.371412 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:52:57.374177 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:52:57.374630 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:52:57.374764 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:52:57.374888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:57.379234 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:52:57.379417 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:52:57.379587 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:52:57.381077 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:52:57.382839 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:52:57.383029 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:52:57.384381 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:52:57.386083 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:52:57.386246 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:52:57.386731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:52:57.388115 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:52:57.388265 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:52:57.388388 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:52:57.388947 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:52:57.390348 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:52:57.390491 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:52:57.391474 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:52:57.392266 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:52:57.371529 => 2025-01-01 14:52:57.392231
[0m14:52:57.392438 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:52:57.392944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83c0fa0>]}
[0m14:52:57.393334 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m14:52:57.393649 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:52:57.395039 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:52:57.395263 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:52:57.395739 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:52:57.395960 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:52:57.399018 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:52:57.396087 => 2025-01-01 14:52:57.398976
[0m14:52:57.401288 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:52:57.401555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83ff4c0>]}
[0m14:52:57.401816 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.01s]
[0m14:52:57.402091 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:52:57.402305 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:52:57.402579 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:52:57.403017 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:52:57.403194 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:52:57.404983 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:52:57.405716 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:52:57.403317 => 2025-01-01 14:52:57.405683
[0m14:52:57.405883 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:52:57.408650 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:52:57.409112 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:52:57.409244 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:52:57.409365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:57.414385 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:52:57.414627 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:52:57.414781 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:52:57.416625 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:52:57.418524 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:52:57.418726 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:52:57.419372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:52:57.420620 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:52:57.420831 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:52:57.420979 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:52:57.421566 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:52:57.422913 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:52:57.423067 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:52:57.423525 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:52:57.424330 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:52:57.406008 => 2025-01-01 14:52:57.424294
[0m14:52:57.424500 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:52:57.425026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e59645e6-0a2e-45a6-a342-75040d0f805d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83fd180>]}
[0m14:52:57.425331 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m14:52:57.425595 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:52:57.426819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:57.427089 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:57.427255 [debug] [MainThread]: On master: BEGIN
[0m14:52:57.427391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:57.430913 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:52:57.431090 [debug] [MainThread]: On master: COMMIT
[0m14:52:57.431233 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:57.431365 [debug] [MainThread]: On master: COMMIT
[0m14:52:57.431813 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:52:57.432006 [debug] [MainThread]: On master: Close
[0m14:52:57.432463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:57.432642 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m14:52:57.432779 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:52:57.433160 [info ] [MainThread]: 
[0m14:52:57.433572 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:52:57.433947 [debug] [MainThread]: Command end result
[0m14:52:57.439474 [info ] [MainThread]: 
[0m14:52:57.439770 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:57.440059 [info ] [MainThread]: 
[0m14:52:57.440302 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:52:57.440528 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:52:57.440784 [info ] [MainThread]: 
[0m14:52:57.441055 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:52:57.441444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb720250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb722590>]}
[0m14:52:57.441728 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:54:30.783461 | dd1d7ddd-d0e8-4533-a40c-71a3973e68d5 ==============================
[0m14:54:30.783461 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:54:30.790980 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:54:30.791299 [debug] [MainThread]: Tracking: tracking
[0m14:54:30.804766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m14:54:30.820890 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:54:30.847229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:30.851176 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:54:30.908929 [debug] [MainThread]: 1603: static parser failed on example/film_ratings.sql
[0m14:54:30.922452 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/film_ratings.sql
[0m14:54:30.960420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84c3eb0>]}
[0m14:54:30.969008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7024a0>]}
[0m14:54:30.969304 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:54:30.969601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72e140>]}
[0m14:54:30.971222 [info ] [MainThread]: 
[0m14:54:30.972999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:30.974330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:54:30.982244 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:54:30.982470 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:54:30.982674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:31.024483 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:54:31.025963 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:54:31.028357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:54:31.032403 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:54:31.032627 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:54:31.032821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:31.037943 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:54:31.038186 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:54:31.038402 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:54:31.039938 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:54:31.040989 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:54:31.041682 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:54:31.046026 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:31.046272 [debug] [MainThread]: On master: BEGIN
[0m14:54:31.046463 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:31.051114 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:31.051339 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:31.051531 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:31.055227 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:54:31.056019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e128c0>]}
[0m14:54:31.056340 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:31.056967 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:31.057177 [debug] [MainThread]: On master: BEGIN
[0m14:54:31.058147 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:31.058351 [debug] [MainThread]: On master: COMMIT
[0m14:54:31.058535 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:31.058709 [debug] [MainThread]: On master: COMMIT
[0m14:54:31.059284 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:54:31.059522 [debug] [MainThread]: On master: Close
[0m14:54:31.060022 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:31.060385 [info ] [MainThread]: 
[0m14:54:31.073190 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:54:31.073611 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:54:31.074290 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:54:31.074595 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:54:31.076602 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:54:31.078574 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:54:31.074791 => 2025-01-01 14:54:31.078519
[0m14:54:31.078791 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:54:31.106321 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:54:31.107304 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:54:31.107500 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:54:31.107674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:31.112635 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:54:31.112802 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:54:31.112946 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:54:31.114899 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:54:31.119151 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:54:31.119331 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:54:31.120015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:54:31.121758 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:54:31.121925 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:54:31.122418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:54:31.136805 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:54:31.137057 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:54:31.137232 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:54:31.138162 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:54:31.141429 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:54:31.141606 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:54:31.142831 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:54:31.143737 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:54:31.078957 => 2025-01-01 14:54:31.143691
[0m14:54:31.143941 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:54:31.144512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702680>]}
[0m14:54:31.145383 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:54:31.146834 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:54:31.147130 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:54:31.147419 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:54:31.147896 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:54:31.148086 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:54:31.149785 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:54:31.150418 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:54:31.148214 => 2025-01-01 14:54:31.150382
[0m14:54:31.150608 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:54:31.153956 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:54:31.154451 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:54:31.154593 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:54:31.154734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:31.158434 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:54:31.158679 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:54:31.158861 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:54:31.160402 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:54:31.162310 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:54:31.162509 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:54:31.163196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:54:31.164982 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:54:31.165145 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:54:31.165689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:54:31.167060 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:54:31.167231 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:54:31.167369 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:54:31.167965 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:54:31.169303 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:54:31.169459 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:54:31.170355 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:54:31.171109 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:54:31.150738 => 2025-01-01 14:54:31.171077
[0m14:54:31.171308 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:54:31.171818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7029e0>]}
[0m14:54:31.172163 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.02s]
[0m14:54:31.172492 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:54:31.172893 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:54:31.173215 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:54:31.173694 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:54:31.173876 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:54:31.175644 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:54:31.176214 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:54:31.174018 => 2025-01-01 14:54:31.176172
[0m14:54:31.176407 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:54:31.179211 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:54:31.179680 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:54:31.179816 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:54:31.179950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:31.183473 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:54:31.183660 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:54:31.183822 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:54:31.185336 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:54:31.187181 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:54:31.187396 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:54:31.188055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:54:31.189800 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:54:31.189961 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:54:31.190471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:54:31.191823 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:54:31.191993 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:54:31.192136 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:54:31.192687 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:54:31.194083 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:54:31.194238 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:54:31.195212 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:54:31.196020 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:54:31.176534 => 2025-01-01 14:54:31.195976
[0m14:54:31.196182 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:54:31.196687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702620>]}
[0m14:54:31.197025 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m14:54:31.197327 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:54:31.198834 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:54:31.199084 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:54:31.199563 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:54:31.199784 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:54:31.202894 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:54:31.199937 => 2025-01-01 14:54:31.202843
[0m14:54:31.205085 [debug] [Thread-1 (]: Compilation Error in model film_ratings (models/example/film_ratings.sql)
  'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:54:31.205333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83ff430>]}
[0m14:54:31.205612 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model public.film_ratings ...................... [[31mERROR[0m in 0.01s]
[0m14:54:31.205900 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:54:31.206140 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:54:31.206404 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:54:31.206885 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:54:31.207056 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:54:31.208836 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:54:31.209776 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:54:31.207175 => 2025-01-01 14:54:31.209740
[0m14:54:31.209994 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:54:31.212697 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:54:31.213174 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:54:31.213312 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:54:31.213435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:31.217414 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:54:31.217601 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:54:31.217773 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:54:31.220037 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:54:31.221840 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:54:31.222142 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:54:31.223264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:54:31.224504 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:54:31.224663 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:54:31.224783 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:54:31.225388 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:54:31.226761 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:54:31.226921 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:54:31.227397 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:54:31.228177 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:54:31.210143 => 2025-01-01 14:54:31.228145
[0m14:54:31.228349 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:54:31.228873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd1d7ddd-d0e8-4533-a40c-71a3973e68d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83fdd20>]}
[0m14:54:31.229193 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m14:54:31.229538 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:54:31.230658 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:31.230921 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:31.231082 [debug] [MainThread]: On master: BEGIN
[0m14:54:31.231224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:31.234662 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:31.234853 [debug] [MainThread]: On master: COMMIT
[0m14:54:31.235015 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:31.235152 [debug] [MainThread]: On master: COMMIT
[0m14:54:31.235610 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:54:31.235803 [debug] [MainThread]: On master: Close
[0m14:54:31.236258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:31.236444 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:54:31.236816 [info ] [MainThread]: 
[0m14:54:31.237248 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:54:31.237637 [debug] [MainThread]: Command end result
[0m14:54:31.243223 [info ] [MainThread]: 
[0m14:54:31.243510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:54:31.243757 [info ] [MainThread]: 
[0m14:54:31.244062 [error] [MainThread]: [33mCompilation Error in model film_ratings (models/example/film_ratings.sql)[0m
[0m14:54:31.244372 [error] [MainThread]:   'generate_film_ratings' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:54:31.244617 [info ] [MainThread]: 
[0m14:54:31.244811 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:54:31.245101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7234f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7235b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723370>]}
[0m14:54:31.245344 [debug] [MainThread]: Flushing usage events


============================== 2025-01-01 14:55:13.688086 | 82fa68d1-c3f9-439e-8190-6bebceb0e273 ==============================
[0m14:55:13.688086 [info ] [MainThread]: Running with dbt=1.4.7
[0m14:55:13.693878 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:55:13.694097 [debug] [MainThread]: Tracking: tracking
[0m14:55:13.707949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m14:55:13.717997 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m14:55:13.743952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:13.744472 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_ratings.sql
[0m14:55:13.810096 [debug] [MainThread]: 1699: static parser successfully parsed example/film_ratings.sql
[0m14:55:13.858395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff84bfeb0>]}
[0m14:55:13.867080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb702500>]}
[0m14:55:13.867342 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m14:55:13.867589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72dd20>]}
[0m14:55:13.869023 [info ] [MainThread]: 
[0m14:55:13.870652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:13.871943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m14:55:13.879739 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m14:55:13.880050 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m14:55:13.880249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:13.921236 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m14:55:13.922597 [debug] [ThreadPool]: On list_destination_db: Close
[0m14:55:13.924966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m14:55:13.929139 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:55:13.929361 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m14:55:13.929559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:13.934761 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:55:13.935132 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m14:55:13.935393 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m14:55:13.937013 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:55:13.938152 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m14:55:13.938887 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m14:55:13.943442 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:13.943706 [debug] [MainThread]: On master: BEGIN
[0m14:55:13.943904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:13.948383 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:55:13.948602 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:13.948823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:55:13.951891 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m14:55:13.952660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e16890>]}
[0m14:55:13.953003 [debug] [MainThread]: On master: ROLLBACK
[0m14:55:13.953657 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:13.953846 [debug] [MainThread]: On master: BEGIN
[0m14:55:13.954834 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:55:13.955076 [debug] [MainThread]: On master: COMMIT
[0m14:55:13.955265 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:13.955442 [debug] [MainThread]: On master: COMMIT
[0m14:55:13.956074 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:55:13.956361 [debug] [MainThread]: On master: Close
[0m14:55:13.956878 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:13.957181 [info ] [MainThread]: 
[0m14:55:13.968984 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m14:55:13.969385 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m14:55:13.970008 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m14:55:13.970317 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m14:55:13.972317 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m14:55:13.974241 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-01 14:55:13.970487 => 2025-01-01 14:55:13.974182
[0m14:55:13.974463 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m14:55:14.003233 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m14:55:14.004172 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:55:14.004338 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m14:55:14.004483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.009490 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:55:14.009658 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:55:14.009803 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m14:55:14.011537 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:55:14.016190 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:55:14.016453 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m14:55:14.017258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:55:14.019115 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:55:14.019285 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m14:55:14.019780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:55:14.034505 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:55:14.034720 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:55:14.034899 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m14:55:14.035832 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:55:14.039001 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m14:55:14.039177 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m14:55:14.040361 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:55:14.041282 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-01 14:55:13.974623 => 2025-01-01 14:55:14.041205
[0m14:55:14.041498 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m14:55:14.042084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8542830>]}
[0m14:55:14.042824 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.07s]
[0m14:55:14.044297 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m14:55:14.044619 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m14:55:14.044961 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m14:55:14.045467 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m14:55:14.045719 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m14:55:14.047535 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m14:55:14.048163 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-01 14:55:14.045850 => 2025-01-01 14:55:14.048125
[0m14:55:14.048336 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m14:55:14.051254 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m14:55:14.051738 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:55:14.051889 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m14:55:14.052015 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.056498 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:55:14.056698 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:55:14.056857 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m14:55:14.058307 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:55:14.060867 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:55:14.061044 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m14:55:14.061648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:55:14.063420 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:55:14.063577 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m14:55:14.064199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:55:14.065595 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:55:14.065754 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:55:14.065885 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m14:55:14.066497 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:55:14.067837 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m14:55:14.068004 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m14:55:14.068973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:55:14.069726 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-01 14:55:14.048454 => 2025-01-01 14:55:14.069696
[0m14:55:14.069914 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m14:55:14.070424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e83d30>]}
[0m14:55:14.070741 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m14:55:14.071065 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m14:55:14.071404 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m14:55:14.071678 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m14:55:14.072174 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m14:55:14.072372 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m14:55:14.074148 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m14:55:14.074681 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-01 14:55:14.072487 => 2025-01-01 14:55:14.074644
[0m14:55:14.074872 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m14:55:14.077563 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m14:55:14.078031 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:55:14.078190 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m14:55:14.078319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.082308 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:55:14.082534 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:55:14.082695 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m14:55:14.084120 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:55:14.085978 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:55:14.086173 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m14:55:14.086804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:55:14.088485 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:55:14.088655 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m14:55:14.089161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:55:14.090537 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:55:14.090696 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:55:14.090820 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m14:55:14.091395 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:55:14.092848 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m14:55:14.093003 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m14:55:14.094000 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:55:14.094769 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-01 14:55:14.074988 => 2025-01-01 14:55:14.094736
[0m14:55:14.094935 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m14:55:14.095467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8542e90>]}
[0m14:55:14.095791 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m14:55:14.096268 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m14:55:14.097760 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m14:55:14.098023 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m14:55:14.098500 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m14:55:14.098699 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m14:55:14.101165 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m14:55:14.101802 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-01 14:55:14.098846 => 2025-01-01 14:55:14.101748
[0m14:55:14.101983 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m14:55:14.105688 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m14:55:14.106190 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:55:14.106342 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m14:55:14.106467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.110547 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:55:14.110734 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:55:14.110891 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m14:55:14.114106 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m14:55:14.116037 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:55:14.116205 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m14:55:14.116764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:55:14.118009 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:55:14.118179 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:55:14.118320 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m14:55:14.118860 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:55:14.120193 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m14:55:14.120339 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m14:55:14.120803 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:55:14.121540 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-01 14:55:14.102103 => 2025-01-01 14:55:14.121508
[0m14:55:14.121694 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m14:55:14.122236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e7640>]}
[0m14:55:14.122591 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.02s]
[0m14:55:14.122907 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m14:55:14.123253 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m14:55:14.123538 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m14:55:14.123999 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m14:55:14.124190 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m14:55:14.126088 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m14:55:14.126770 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-01 14:55:14.124305 => 2025-01-01 14:55:14.126737
[0m14:55:14.126959 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m14:55:14.129738 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m14:55:14.130209 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:55:14.130344 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m14:55:14.130465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:14.135109 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m14:55:14.135270 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:55:14.135416 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Dunkirk'
  );
  
[0m14:55:14.137018 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m14:55:14.138893 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:55:14.139129 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m14:55:14.140170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m14:55:14.141484 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:55:14.141671 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:55:14.141813 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m14:55:14.142468 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m14:55:14.143830 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m14:55:14.143990 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m14:55:14.144458 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m14:55:14.145254 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-01 14:55:14.127076 => 2025-01-01 14:55:14.145220
[0m14:55:14.145412 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m14:55:14.145888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82fa68d1-c3f9-439e-8190-6bebceb0e273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e6ec0>]}
[0m14:55:14.146214 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m14:55:14.146500 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m14:55:14.147562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:55:14.147776 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:14.147935 [debug] [MainThread]: On master: BEGIN
[0m14:55:14.148076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:14.152744 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:55:14.152948 [debug] [MainThread]: On master: COMMIT
[0m14:55:14.153108 [debug] [MainThread]: Using postgres connection "master"
[0m14:55:14.153249 [debug] [MainThread]: On master: COMMIT
[0m14:55:14.153673 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:55:14.153834 [debug] [MainThread]: On master: Close
[0m14:55:14.154257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:14.154435 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m14:55:14.154582 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m14:55:14.154997 [info ] [MainThread]: 
[0m14:55:14.155298 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m14:55:14.155767 [debug] [MainThread]: Command end result
[0m14:55:14.161503 [info ] [MainThread]: 
[0m14:55:14.161772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:14.162009 [info ] [MainThread]: 
[0m14:55:14.162224 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:55:14.162510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72c8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e7640>]}
[0m14:55:14.162729 [debug] [MainThread]: Flushing usage events


============================== 2025-01-02 15:06:21.064777 | 87b5a0c7-62ef-45e8-98a3-7d8a5f010554 ==============================
[0m15:06:21.064777 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:06:21.068175 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:06:21.070272 [debug] [MainThread]: Tracking: tracking
[0m15:06:21.084235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m15:06:21.101929 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:06:21.130154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:21.134384 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/specific_movie.sql
[0m15:06:21.163377 [debug] [MainThread]: 1603: static parser failed on example/specific_movie.sql
[0m15:06:21.175627 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/specific_movie.sql
[0m15:06:21.186069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ea5f00>]}
[0m15:06:21.195590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd05e830>]}
[0m15:06:21.195999 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:06:21.196368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd05fc40>]}
[0m15:06:21.198345 [info ] [MainThread]: 
[0m15:06:21.200233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:21.202866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:06:21.211025 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:06:21.211390 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:06:21.211663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:21.255288 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m15:06:21.256995 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:06:21.260596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:06:21.265087 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:06:21.265323 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:06:21.265525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:21.270565 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:06:21.270819 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:06:21.271033 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:06:21.272535 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m15:06:21.273576 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:06:21.274249 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:06:21.278884 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:21.279166 [debug] [MainThread]: On master: BEGIN
[0m15:06:21.279399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:21.283917 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:06:21.284186 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:21.284384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:06:21.288179 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:06:21.289482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9eb2b60>]}
[0m15:06:21.289874 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:21.290542 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:21.290819 [debug] [MainThread]: On master: BEGIN
[0m15:06:21.291951 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:06:21.292189 [debug] [MainThread]: On master: COMMIT
[0m15:06:21.292461 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:21.292666 [debug] [MainThread]: On master: COMMIT
[0m15:06:21.293287 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:06:21.293493 [debug] [MainThread]: On master: Close
[0m15:06:21.293989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:21.294337 [info ] [MainThread]: 
[0m15:06:21.306898 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m15:06:21.307361 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m15:06:21.308018 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m15:06:21.308480 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m15:06:21.310850 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m15:06:21.312614 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-02 15:06:21.308725 => 2025-01-02 15:06:21.312525
[0m15:06:21.312929 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m15:06:21.342377 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m15:06:21.343639 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:06:21.343859 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m15:06:21.344056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:21.348277 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:06:21.348511 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:06:21.348696 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:06:21.350427 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:06:21.355612 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:06:21.355901 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m15:06:21.357622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:06:21.359685 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:06:21.359868 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:06:21.360464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:06:21.375520 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m15:06:21.375733 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:06:21.375910 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m15:06:21.376841 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:06:21.380157 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:06:21.380335 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m15:06:21.381551 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:06:21.382456 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-02 15:06:21.313185 => 2025-01-02 15:06:21.382403
[0m15:06:21.382630 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m15:06:21.383211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d7d270>]}
[0m15:06:21.384014 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m15:06:21.385580 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m15:06:21.385913 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m15:06:21.386256 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m15:06:21.386716 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m15:06:21.386900 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m15:06:21.388752 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m15:06:21.389405 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-02 15:06:21.387038 => 2025-01-02 15:06:21.389368
[0m15:06:21.389590 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m15:06:21.392457 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m15:06:21.392954 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:06:21.393091 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m15:06:21.393226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:21.397412 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:06:21.397600 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:06:21.397754 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:06:21.399567 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:06:21.401510 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:06:21.401720 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m15:06:21.402410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:06:21.404141 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:06:21.404294 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:06:21.404906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:06:21.406310 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m15:06:21.406466 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:06:21.406593 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m15:06:21.407175 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:06:21.408530 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:06:21.408692 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m15:06:21.409617 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:06:21.410373 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-02 15:06:21.389709 => 2025-01-02 15:06:21.410339
[0m15:06:21.410533 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m15:06:21.411088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d7d600>]}
[0m15:06:21.411472 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.02s]
[0m15:06:21.411757 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m15:06:21.412115 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m15:06:21.412387 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m15:06:21.412847 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m15:06:21.413022 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m15:06:21.414805 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m15:06:21.415422 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-02 15:06:21.413153 => 2025-01-02 15:06:21.415388
[0m15:06:21.415589 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m15:06:21.419143 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m15:06:21.419760 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:06:21.419923 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m15:06:21.420073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:21.424652 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:06:21.424817 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:06:21.424961 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:06:21.426972 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:06:21.428831 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:06:21.428995 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m15:06:21.429606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:06:21.431290 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:06:21.431447 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:06:21.431966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:06:21.433298 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m15:06:21.433456 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:06:21.433597 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m15:06:21.434388 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:06:21.435734 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:06:21.435879 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m15:06:21.436940 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:06:21.437763 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-02 15:06:21.415717 => 2025-01-02 15:06:21.437723
[0m15:06:21.437934 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m15:06:21.438508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83dd240>]}
[0m15:06:21.438913 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m15:06:21.439295 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m15:06:21.440854 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m15:06:21.441109 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m15:06:21.441558 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m15:06:21.441735 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m15:06:21.444089 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m15:06:21.444893 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-02 15:06:21.441850 => 2025-01-02 15:06:21.444857
[0m15:06:21.445069 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m15:06:21.447932 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m15:06:21.448467 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:06:21.448614 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m15:06:21.448758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:21.454572 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:06:21.454778 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:06:21.454945 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m15:06:21.457989 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:06:21.459974 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:06:21.460157 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m15:06:21.460774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:06:21.462000 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m15:06:21.462160 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:06:21.462282 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m15:06:21.463144 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:06:21.464522 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:06:21.464679 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m15:06:21.465275 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:06:21.466160 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-02 15:06:21.445181 => 2025-01-02 15:06:21.466123
[0m15:06:21.466344 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m15:06:21.466894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9ea72e0>]}
[0m15:06:21.467272 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.03s]
[0m15:06:21.467598 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m15:06:21.467988 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m15:06:21.468290 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m15:06:21.468735 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m15:06:21.468919 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m15:06:21.470948 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m15:06:21.471613 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-02 15:06:21.469053 => 2025-01-02 15:06:21.471577
[0m15:06:21.471782 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m15:06:21.475269 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m15:06:21.475772 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:06:21.475903 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m15:06:21.476031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:21.479770 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:06:21.479936 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:06:21.480096 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Inception'
  );
  
[0m15:06:21.481756 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m15:06:21.483587 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:06:21.483752 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m15:06:21.484457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:06:21.485770 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m15:06:21.485925 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:06:21.486069 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m15:06:21.486657 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:06:21.487964 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:06:21.488127 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m15:06:21.488696 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:06:21.489503 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-02 15:06:21.471894 => 2025-01-02 15:06:21.489465
[0m15:06:21.489684 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m15:06:21.490193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87b5a0c7-62ef-45e8-98a3-7d8a5f010554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83aa440>]}
[0m15:06:21.490512 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m15:06:21.490925 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m15:06:21.492129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:21.492372 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:21.492521 [debug] [MainThread]: On master: BEGIN
[0m15:06:21.492660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:21.496671 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:06:21.496912 [debug] [MainThread]: On master: COMMIT
[0m15:06:21.497088 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:21.497230 [debug] [MainThread]: On master: COMMIT
[0m15:06:21.497740 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:06:21.497927 [debug] [MainThread]: On master: Close
[0m15:06:21.498338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:21.498509 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m15:06:21.498633 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m15:06:21.499044 [info ] [MainThread]: 
[0m15:06:21.499397 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m15:06:21.499910 [debug] [MainThread]: Command end result
[0m15:06:21.505384 [info ] [MainThread]: 
[0m15:06:21.505690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:21.505961 [info ] [MainThread]: 
[0m15:06:21.506275 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:06:21.506606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83fc0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83fd660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83fc9d0>]}
[0m15:06:21.506887 [debug] [MainThread]: Flushing usage events


============================== 2025-01-02 15:56:15.053138 | 65aa808a-b8ec-4cb3-97d3-1e50374585b1 ==============================
[0m15:56:15.053138 [info ] [MainThread]: Running with dbt=1.4.7
[0m15:56:15.058568 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:56:15.058899 [debug] [MainThread]: Tracking: tracking
[0m15:56:15.073383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m15:56:15.100548 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m15:56:15.128262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:15.128570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:15.135746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e54e50>]}
[0m15:56:15.158428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a470>]}
[0m15:56:15.158854 [info ] [MainThread]: Found 5 models, 19 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m15:56:15.159218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f9a4d0>]}
[0m15:56:15.160932 [info ] [MainThread]: 
[0m15:56:15.162819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:15.165115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m15:56:15.174616 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m15:56:15.174973 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m15:56:15.175235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:15.244727 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m15:56:15.247070 [debug] [ThreadPool]: On list_destination_db: Close
[0m15:56:15.249973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m15:56:15.255272 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:56:15.255726 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m15:56:15.256025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:15.262199 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:56:15.262556 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m15:56:15.262837 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m15:56:15.264431 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m15:56:15.265511 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m15:56:15.266191 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m15:56:15.271277 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:15.271611 [debug] [MainThread]: On master: BEGIN
[0m15:56:15.271876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:15.277127 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:56:15.277366 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:15.277658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:56:15.280987 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:56:15.281831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e990f0>]}
[0m15:56:15.282174 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:15.282795 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:15.282988 [debug] [MainThread]: On master: BEGIN
[0m15:56:15.284058 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:56:15.284276 [debug] [MainThread]: On master: COMMIT
[0m15:56:15.284483 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:15.284666 [debug] [MainThread]: On master: COMMIT
[0m15:56:15.285242 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:56:15.285445 [debug] [MainThread]: On master: Close
[0m15:56:15.285946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:15.286324 [info ] [MainThread]: 
[0m15:56:15.298405 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m15:56:15.298871 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m15:56:15.299550 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m15:56:15.299923 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m15:56:15.302244 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m15:56:15.303810 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-01-02 15:56:15.300133 => 2025-01-02 15:56:15.303737
[0m15:56:15.304126 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m15:56:15.335008 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m15:56:15.336350 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:56:15.336565 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m15:56:15.336805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:15.342202 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:56:15.342441 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:56:15.342630 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m15:56:15.344484 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:56:15.349253 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:56:15.349500 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m15:56:15.350118 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:56:15.352086 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:56:15.352262 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m15:56:15.352850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:56:15.368090 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m15:56:15.368318 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:56:15.368541 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m15:56:15.369454 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:56:15.372760 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m15:56:15.372938 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m15:56:15.374198 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:56:15.375127 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-01-02 15:56:15.304339 => 2025-01-02 15:56:15.375080
[0m15:56:15.375320 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m15:56:15.375907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d3ae00>]}
[0m15:56:15.376684 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m15:56:15.378033 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m15:56:15.378314 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m15:56:15.378602 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m15:56:15.379050 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m15:56:15.379248 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m15:56:15.380989 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m15:56:15.381628 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-01-02 15:56:15.379369 => 2025-01-02 15:56:15.381591
[0m15:56:15.381812 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m15:56:15.384781 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m15:56:15.385270 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:56:15.385418 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m15:56:15.385549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:15.390392 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:56:15.390567 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:56:15.390699 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m15:56:15.392409 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:56:15.394628 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:56:15.394830 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m15:56:15.395403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:56:15.397463 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:56:15.397634 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m15:56:15.398202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:56:15.399699 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m15:56:15.399850 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:56:15.399976 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m15:56:15.400581 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:56:15.402642 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m15:56:15.402805 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m15:56:15.403782 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:56:15.404560 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-01-02 15:56:15.381934 => 2025-01-02 15:56:15.404526
[0m15:56:15.404739 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m15:56:15.405306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d8c160>]}
[0m15:56:15.405679 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m15:56:15.406045 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m15:56:15.406454 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m15:56:15.406721 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m15:56:15.407157 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m15:56:15.407333 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m15:56:15.409057 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m15:56:15.409603 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-01-02 15:56:15.407457 => 2025-01-02 15:56:15.409565
[0m15:56:15.409787 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m15:56:15.412527 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m15:56:15.413021 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:56:15.413172 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m15:56:15.413305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:15.417819 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:56:15.418003 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:56:15.418183 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m15:56:15.420028 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:56:15.421862 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:56:15.422091 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m15:56:15.422788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:56:15.424537 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:56:15.424693 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m15:56:15.425249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:56:15.426759 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m15:56:15.426931 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:56:15.427058 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m15:56:15.427812 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:56:15.429166 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m15:56:15.429325 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m15:56:15.430394 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:56:15.431196 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-01-02 15:56:15.409894 => 2025-01-02 15:56:15.431158
[0m15:56:15.431389 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m15:56:15.431922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d87640>]}
[0m15:56:15.432300 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.02s]
[0m15:56:15.432638 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m15:56:15.433932 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_ratings
[0m15:56:15.434328 [info ] [Thread-1 (]: 4 of 5 START sql table model public.film_ratings ............................... [RUN]
[0m15:56:15.434842 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_ratings'
[0m15:56:15.435050 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_ratings
[0m15:56:15.437519 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_ratings"
[0m15:56:15.438122 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (compile): 2025-01-02 15:56:15.435172 => 2025-01-02 15:56:15.438086
[0m15:56:15.438301 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_ratings
[0m15:56:15.441268 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_ratings"
[0m15:56:15.441799 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:56:15.441948 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: BEGIN
[0m15:56:15.442078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:15.445974 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:56:15.446150 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:56:15.446285 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */

  
    

  create  table "destination_db"."public"."film_ratings__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,title,release_date,price,rating,user_rating,
        CASE
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Dood'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END as rating_category
    FROM "destination_db"."public"."films"
),

films_with_actors AS(
    SELECT
        f.film_id, f.title,
        STRING_AGG(a.actor_name, ',') AS actors
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY  f.film_id, f.title
)

SELECT fwf.*, fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m15:56:15.449124 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m15:56:15.451094 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:56:15.451417 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
alter table "destination_db"."public"."film_ratings__dbt_tmp" rename to "film_ratings"
[0m15:56:15.452821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:56:15.454041 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m15:56:15.454213 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:56:15.454349 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: COMMIT
[0m15:56:15.455147 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:56:15.456495 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_ratings"
[0m15:56:15.457419 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_ratings"} */
drop table if exists "destination_db"."public"."film_ratings__dbt_backup" cascade
[0m15:56:15.457939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:56:15.458735 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_ratings (execute): 2025-01-02 15:56:15.438449 => 2025-01-02 15:56:15.458701
[0m15:56:15.458924 [debug] [Thread-1 (]: On model.custom_postgres.film_ratings: Close
[0m15:56:15.459459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83a2bc0>]}
[0m15:56:15.459827 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.film_ratings .......................... [[32mSELECT 20[0m in 0.02s]
[0m15:56:15.460150 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_ratings
[0m15:56:15.460485 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_movie
[0m15:56:15.460737 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_movie ............................. [RUN]
[0m15:56:15.461260 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_movie'
[0m15:56:15.461506 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_movie
[0m15:56:15.463514 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_movie"
[0m15:56:15.464077 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (compile): 2025-01-02 15:56:15.461636 => 2025-01-02 15:56:15.464043
[0m15:56:15.464245 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_movie
[0m15:56:15.466964 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_movie"
[0m15:56:15.467487 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:56:15.467630 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: BEGIN
[0m15:56:15.467757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:15.473229 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m15:56:15.473419 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:56:15.473571 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */

  
    

  create  table "destination_db"."public"."specific_movie__dbt_tmp"
  as (
    

SELECT *
FROM "destination_db"."public"."films"
WHERE title = 'Inception'
  );
  
[0m15:56:15.475464 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m15:56:15.477621 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:56:15.477845 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
alter table "destination_db"."public"."specific_movie__dbt_tmp" rename to "specific_movie"
[0m15:56:15.478432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m15:56:15.479882 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m15:56:15.480055 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:56:15.480200 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: COMMIT
[0m15:56:15.480809 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m15:56:15.482284 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_movie"
[0m15:56:15.482449 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_movie"} */
drop table if exists "destination_db"."public"."specific_movie__dbt_backup" cascade
[0m15:56:15.482967 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m15:56:15.483802 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_movie (execute): 2025-01-02 15:56:15.464358 => 2025-01-02 15:56:15.483762
[0m15:56:15.483980 [debug] [Thread-1 (]: On model.custom_postgres.specific_movie: Close
[0m15:56:15.484501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65aa808a-b8ec-4cb3-97d3-1e50374585b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d9eda0>]}
[0m15:56:15.484843 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_movie ........................ [[32mSELECT 1[0m in 0.02s]
[0m15:56:15.485137 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_movie
[0m15:56:15.486306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:15.486542 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:15.486698 [debug] [MainThread]: On master: BEGIN
[0m15:56:15.486837 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:15.490937 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:56:15.491172 [debug] [MainThread]: On master: COMMIT
[0m15:56:15.491340 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:15.491489 [debug] [MainThread]: On master: COMMIT
[0m15:56:15.491990 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:56:15.492208 [debug] [MainThread]: On master: Close
[0m15:56:15.492644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:15.492827 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m15:56:15.492986 [debug] [MainThread]: Connection 'model.custom_postgres.specific_movie' was properly closed.
[0m15:56:15.493412 [info ] [MainThread]: 
[0m15:56:15.493690 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:56:15.494123 [debug] [MainThread]: Command end result
[0m15:56:15.499589 [info ] [MainThread]: 
[0m15:56:15.499909 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:15.500157 [info ] [MainThread]: 
[0m15:56:15.500394 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:56:15.500717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d3bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d381f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d38130>]}
[0m15:56:15.500954 [debug] [MainThread]: Flushing usage events
